<!DOCTYPE html>
<html lang="en"><head>
<script src="tidyverse-training_files/libs/clipboard/clipboard.min.js"></script>
<script src="tidyverse-training_files/libs/quarto-html/tabby.min.js"></script>
<script src="tidyverse-training_files/libs/quarto-html/popper.min.js"></script>
<script src="tidyverse-training_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="tidyverse-training_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tidyverse-training_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="tidyverse-training_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.313">

  <title>tidyverse-training</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="tidyverse-training_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="tidyverse-training_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="tidyverse-training_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="tidyverse-training_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="tidyverse-training_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="tidyverse-training_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="tidyverse-training_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="tidyverse-training_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="tidyverse-training_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="tidyverse-training_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="tidyverse-training_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section>
<section id="section" class="title-slide slide level1 center" data-background-image="images/background_title.png">
<h1></h1>
<p><span style="color:#ffffff; font-size: 2em">Formation R</span></p>
<p><span style="color:#ffffff; font-size: 1.5em">Collection de packages tidyverse</span></p>
<p><span style="color:#ffffff; font-size: 1em">Laure Velez (laure.velez@umontpellier.fr)</span> <br> <span style="color:#ffffff; font-size: 1em">Gael Mariani (gael.mariani@umontpellier.fr)</span> <br> <span style="color:#ffffff; font-size: 1em">Mathieu Depetris (mathieu.depetris@ird.fr)</span> <br> <span style="color:#ffffff; font-size: 1em">Monique Simier (monique.simier@ird.fr)</span> <br> <br> <span style="color:#ffffff; font-size: 1em">05-06 decembre 2022</span> <br> <br> <br> <span style="color:#ffffff; font-size: 0.4em">© RStudio</span></p>
<p><img data-src="images/tidyverse_packages.png" class="absolute" style="top: 60px; right: 20px; width: 35%; "></p>
</section>
<section id="plan-de-la-formation" class="slide level2 smaller">
<h2>Plan de la formation</h2>
<ul>
<li><p>Préambule et introduction</p>
<ul>
<li>Prérequis et environnement de travail nécessaire à la formation</li>
<li>Objectifs de la formation</li>
<li>Présentation de tidyverse</li>
</ul></li>
<li><p>Partie 1 : Importation de données sous R avec readr</p></li>
<li><p>Partie 2 : Manipulation de données avec dplyr</p></li>
<li><p>Partie 3 : Nettoyage des données avec tidyr</p></li>
<li><p>Partie 4 : Extension à la manipulation de données, cas spécifiques</p>
<ul>
<li>4.1 : Manipuler du texte avec stringr</li>
<li>4.2 : Manipuler des dates avec lubridate</li>
</ul></li>
<li><p>Partie 5 : Visualisation graphique avec ggplot2</p></li>
<li><p>Partie 6 : Cas pratiques sur vos données</p></li>
</ul>
<p>Formation fortement inspirée du site de <a href="https://larmarange.github.io/analyse-R/" target="_blank">Joseph Larmarange</a></p>
</section></section>
<section>
<section id="préambule-et-introduction" class="title-slide slide level1 center">
<h1>Préambule et introduction</h1>
<ul>
<li>Prérequis et environnement de travail nécessaire à la formation</li>
<li>Objectifs de la formation</li>
<li>Présentation de tidyverse</li>
</ul>
</section>
<section id="prérequis-et-environnement-de-travail-nécessaire-à-la-formation" class="slide level2">
<h2>Prérequis et environnement de travail nécessaire à la formation</h2>
<ul>
<li>Avoir des notions de base dans l’utilisation de R</li>
<li>Avoir une instance valide de <a href="https://cran.r-project.org/" target="_blank">R</a> sur son poste (durant la formation utilisation de la version 4.2.1)</li>
<li>Avoir installé correctement les versions des packages dplyr (utilisation de la version 1.0.10), lubridate (utilisation de la version 1.8.0), ggplot2 (utilisation de la version 3.3.6) et stringr (utilisation de la version 1.4.1)</li>
</ul>
</section>
<section id="bonus-non-obligatoire" class="slide level2">
<h2>Bonus non obligatoire</h2>
<ul>
<li>Utilisation de l’environnement de développement <a href="https://www.rstudio.com/products/rstudio/download/" target="_blank">Rstudio</a> (utilisation de la version 2022.07.1 Build 554 sous Windows)</li>
<li>Pour les utilisateurs de Windows installation de <a href="https://cran.r-project.org/bin/windows/Rtools/" target="_blank">Rtools</a> (utilisation de la version 4.2)</li>
<li>Installation de <a href="https://code.visualstudio.com/#alt-downloads" target="_blank">Visual Studio Code</a> (éditeur de code source autonome)</li>
<li>Une instance de <a href="https://jdk.java.net/19/" target="_blank">Java</a> (idéalement une version JDK = kit de développement + moteur d’exécution des programmes compilés + outils de compilation)</li>
</ul>
</section>
<section id="objectifs-de-la-formation" class="slide level2">
<h2>Objectifs de la formation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Vous présenter un panel de ce que l’on peut faire avec ces nouvelles méthodes et surtout vous donner les clés pour aller plus loin</li>
<li>Un expert n’est pas forcément quelqu’un qui connaît toutes les fonctions de R par cœur, mais qui sait écouter, comprendre et aller chercher les informations dont il a besoin
<ul>
<li>Pensez à jeter un coup d’œil aux <a href="https://github.com/rstudio/cheatsheets" target="_blank">cheatsheets</a></li>
</ul></li>
<li>Prendre le temps de discuter et de regarder vos données et/ou problèmes</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/loi_pareto.jpg"></p>
</div>
</div>
</section>
<section id="présentation-de-tidyverse" class="slide level2 smaller">
<h2>Présentation de Tidyverse</h2>
<div class="columns">
<div class="column" style="width:65%;">
<ul>
<li>Tidyverse c’est quoi ?
<ul>
<li>tidy + universe ou l’univers du «bien rangé» ou du rangement</li>
<li>Collection d’extensions conçues pour travailler ensemble et basées sur une philosophie commune</li>
<li>Le cœur du package inclut 8 packages
<ul>
<li><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a> : création de graphiques</li>
<li><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a> : manipulation de données au sens large</li>
<li><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a> : manipulation de données plus orientées variables</li>
<li><a href="https://readr.tidyverse.org/" target="_blank">readr</a> : import</li>
<li><a href="https://purrr.tidyverse.org/" target="_blank">purrr</a> : fonction de vectorisation (remplacement des boucles classiques)</li>
<li><a href="https://tibble.tidyverse.org/" target="_blank">tibble</a> : «évolution» du data.frame</li>
<li><a href="https://stringr.tidyverse.org/" target="_blank">stringr</a> : manipulation de caractère</li>
<li><a href="https://forcats.tidyverse.org/" target="_blank">forcats</a> : série d’outils pour aider dans la manipulation des facteurs</li>
</ul></li>
</ul></li>
</ul>
</div><div class="column" style="width:35%;">
<p><img data-src="images/hadley_wickham.png" style="width:55.0%"> <img data-src="images/tidyverse_packages.png" style="width:55.0%"></p>
</div>
</div>
</section>
<section id="présentation-de-tidyverse-1" class="slide level2">
<h2>Présentation de Tidyverse</h2>
<ul>
<li>Lancement de la librairie</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Cependant je vous déconseille de faire comme ça
<ul>
<li>En lançant cette commande, on charge dans R tous les packages associés à tidyverse (les 8 packages cités précédemment, mais aussi les dépendances associées)</li>
<li>Avez-vous vraiment besoin de tout cela ?</li>
<li>Potentiel impact sur vos futurs développements (surtout si vous commencez à développer des packages)</li>
<li>L’idée est d’appliquer dès maintenant les bonnes pratiques et surtout de comprendre ce que cela implique de ne pas les suivre (ce qui est aussi votre droit !)</li>
</ul></li>
</ul>
</section>
<section id="avant-daller-plus-loin" class="slide level2">
<h2>Avant d’aller plus loin</h2>
<ul>
<li>L’utilisation de ces packages permet de faire beaucoup de choses, mais ne rend pas tout le reste obsolète</li>
<li>Il y a plusieurs stratégies pour réaliser une action, il faut juste trouver le bon compromis (connaissances, temps de calcul, contexte global de votre projet…)</li>
<li>Attention aux règles et conventions de nommages
<ul>
<li>Règles pour nommer une variable (obligatoire) : ne pas commencer par un chiffre, pas d’espace, que des caractères alpha-numériques (A-z, 0-9) et le tiret du bas (_), ne pas utiliser de mots réservés (comme par exemple TRUE)</li>
<li>Conventions pour nommer une variable (recommandé) : uniquement des lettres minuscules, séparer les mots des _ et les noms choisis doivent pouvoir donner l’information du contenu associé</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="partie-1-importation-de-données-sous-r-avec-readr" class="title-slide slide level1 center">
<h1>Partie 1 : Importation de données sous R avec readr</h1>

<img data-src="images/logo_readr.png" class="r-stretch"></section>
<section id="la-librairie-readr" class="slide level2">
<h2>La librairie <strong>readr</strong></h2>
<ul>
<li>Des fonctions de base de R sont dédiées à l’import de fichiers textes de type csv (<code>read.csv</code>, <code>read.csv2</code>) ou tabulés (<code>read.table</code>) ou avec des séparateurs quelconques (<code>read.delim</code>)</li>
<li>La librairie <strong>readr</strong> propose des fonctions similaires sur le principe mais qui diffèrent des fonctions de base sur certains aspects.</li>
<li>Ces fonctions de <strong>readr</strong> sont compatibles avec l’esprit <strong>Tidyverse</strong> car elles permettent de générer des <em>tibbles</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># install.packages("readr", dependencies = T)</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># install.packages("tibble", dependencies = T)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="un-tibble-cékoiça" class="slide level2">
<h2>Un <strong><em>tibble</em></strong> … Cékoiça ???</h2>
<ul>
<li>Le <em>tibble</em> est une évolution du <em>data frame</em> du R de base</li>
<li>Ce format est géré par le package du même nom qui fait partie du coeur de tidyverse</li>
<li>Les <em>tibbles</em> contiennent un attribut <em>spec</em> qui précise les spécifications des colonnes (nom et type)</li>
<li>Ils s’affichent plus intelligemment que les <em>data frames</em> : seules les premières lignes sont affichées, ainsi que quelques informations supplémentaires utiles</li>
<li>Ils autorisent des noms de colonnes qui sont invalides pour les <em>data frames</em> (espaces, caractères spéciaux, nombres…)</li>
<li>Ils affichent un avertissement si on essaie d’accéder à une colonne qui n’existe pas</li>
<li>Ils n’ont pas de noms de lignes (<em>rownames</em>).</li>
</ul>
</section>
<section id="pour-passer-du-tibble-au-dataframe-et-vice-versa" class="slide level2">
<h2>Pour passer du <em>tibble</em> au <em>dataframe</em> et vice-versa</h2>
<ul>
<li>La plupart des fonctions du tidyverse acceptent des <em>data frames</em> en entrée, mais retournent un objet de classe <em>tibble</em></li>
<li>On peut convertir un <em>data frame</em> en <em>tibble</em> avec la fonction <code>as_tibble</code>, ou l’inverse avec la fonction <code>as.data.frame</code></li>
</ul>
</section>
<section id="les-principales-fonctions-de-la-librairie-readr" class="slide level2">
<h2>Les principales fonctions de la librairie <strong>readr</strong></h2>
<p>Les fonctions de readr les plus utilisées sont :</p>
<ul>
<li><code>read_delim</code> : la plus générale, pour lire un fichier avec un délimiteur quelconque</li>
<li><code>read_csv</code> : fichiers csv au format anglais (point décimal et séparateur virgule)</li>
<li><code>read_csv2</code> : fichiers csv au format français (virgule décimale et séparateur point-virgule)</li>
<li><code>read_xxx_chunked</code> (où xxx = csv, csv2, delim) : pour lire un fichier en “chunks”, c’est à dire en tranches dont on définit la taille en nombre de lignes. Cette fonction permet de lire de très gros fichiers et aussi d’appliquer une fonction (CallBack) sur les données à chaque tranche.</li>
</ul>
</section>
<section id="importer-en-tibble-le-fichier-global_reef_fish_biomass.csv" class="slide level2">
<h2>Importer en <strong><em>tibble</em></strong> le fichier Global_reef_fish_biomass.csv</h2>
<ul>
<li><p>Ce fichier est au format csv anglais (séparateur décimal = point et séparateur de colonnes = virgule).</p></li>
<li><p>Chaque ligne donne une valeur de biomasse pour une campagne (survey_id), une espèce de poisson (species_name) et une classe de taille de 0.5cm (size_class).</p></li>
<li><p>Lecture avec <code>read_delim</code> : preciser le delimiteur de colonnes (ici la virgule)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                                       <span class="at">delim =</span> <span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>0u bien avec <code>read_csv</code> : delimiteur par defaut = virgule</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="le-tibble-global_reef_fish_biomass" class="slide level2">
<h2>Le <strong><em>tibble</em></strong> global_reef_fish_biomass</h2>
<p>On vérifie sa classe avec <code>class()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">class</span>(global_reef_fish_biomass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="le-tibble-global_reef_fish_biomass-1" class="slide level2">
<h2>Le <strong><em>tibble</em></strong> global_reef_fish_biomass</h2>
<p>On vérifie sa structure avec <code>str()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">str</span>(global_reef_fish_biomass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="le-tibble-global_reef_fish_biomass-2" class="slide level2">
<h2>Le <strong><em>tibble</em></strong> global_reef_fish_biomass</h2>
<p>On vérifie son contenu avec <code>head()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">head</span>(global_reef_fish_biomass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-fonction-inverse-write_...-pour-exporter-un-fichier" class="slide level2">
<h2>La fonction inverse : <code>write_...</code> pour exporter un fichier</h2>
<ul>
<li><code>write_csv</code> pour exporter un tibble en csv</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">write_csv</span>(global_reef_fish_biomass, <span class="st">"./data/global_reef_fish_biomass_out.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>ou <code>write_delim</code> pour choisir le délimiteur de colonnes (ici tabulation)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">write_delim</span>(global_reef_fish_biomass, <span class="st">"./data/global_reef_fish_biomass_out2.txt"</span>, <span class="at">delim=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comment-lire-un-fichier-avec-dautres-séparateurs-des-colonnes-et-des-décimales" class="slide level2">
<h2>Comment lire un fichier avec d’autres séparateurs des colonnes et des décimales ?</h2>
<ul>
<li>Pour générer un autre format de fichier, on exporte biomass au format csv “francais” (séparateur décimal=“,’ et séparateur des colonnes=”;“)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">write_csv2</span>(global_reef_fish_biomass, <span class="st">"./data/global_reef_fish_biomass_out3.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Puis on essaie de lire ce nouveau csv au format francais</li>
</ul>
</section>
<section id="option-1-read_csv2" class="slide level2">
<h2>Option 1 : <code>read_csv2</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>global_reef_fish_biomass3 <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass_out3.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">str</span>(global_reef_fish_biomass3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="option-2-read_delim-sans-préciser-le-séparateur-décimal" class="slide level2">
<h2>Option 2 : <code>read_delim</code> sans préciser le séparateur décimal</h2>
<p>PAS BON car les nombres décimaux (ex: biomass) sont lus comme du caractère</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>global_reef_fish_biomass3 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass_out3.csv"</span>,</span>
<span id="cb12-2"><a href="#cb12-2"></a>                                       <span class="at">delim =</span> <span class="st">";"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">str</span>(global_reef_fish_biomass3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="option-3-read_delim-en-précisant-le-séparateur-décimal-avec-locale" class="slide level2">
<h2>Option 3 : read_delim en précisant le séparateur décimal avec locale()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>global_reef_fish_biomass3 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass_out3.csv"</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                                        <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                                        <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">","</span>))</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="fu">str</span>(global_reef_fish_biomass3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="le-type-des-colonnes" class="slide level2">
<h2>Le type des colonnes</h2>
<p>Afficher les specifications avec <code>spec</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">spec</span>(global_reef_fish_biomass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Simplifier les specifications avec <code>col_condense</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">cols_condense</span>(<span class="fu">spec</span>(global_reef_fish_biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forcer-le-type-dune-colonne" class="slide level2">
<h2>Forcer le type d’une colonne</h2>
<p>Avec le paramètre <code>col_types = list(...)</code>, on choisit de lire survey_id comme un entier <code>col_integer()</code>, method et block comme des facteurs <code>col_factor()</code>. Pour block on définit aussi des levels avec un certain ordre :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>,</span>
<span id="cb16-2"><a href="#cb16-2"></a>                  <span class="at">col_types =</span> <span class="fu">list</span>(<span class="at">survey_id =</span> <span class="fu">col_integer</span>(),</span>
<span id="cb16-3"><a href="#cb16-3"></a>                                   <span class="at">method =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb16-4"><a href="#cb16-4"></a>                                   <span class="at">block =</span> <span class="fu">col_factor</span>(<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"2"</span>,<span class="st">"1"</span>))))</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">spec</span>(global_reef_fish_biomass)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="fu">levels</span>(global_reef_fish_biomass<span class="sc">$</span>block)</span>
<span id="cb16-7"><a href="#cb16-7"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(global_reef_fish_biomass)</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="fu">levels</span>(global_reef_fish_biomass<span class="sc">$</span>block)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importer-en-tibble-le-fichier-survey_metadata.csv" class="slide level2">
<h2>Importer en <strong><em>tibble</em></strong> le fichier Survey_metadata.csv</h2>
<p>Ce fichier contient des métadonnées caractérisant les campagnes (survey_id) Particularités : séparateur “;” et 70 lignes de commentaires au début qui ne doivent pas être lues : utilisation du paramètre <code>skip =</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>survey_metadata <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                              <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>                              <span class="at">skip =</span> <span class="dv">70</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="fu">head</span>(survey_metadata,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="avantages-de-readr-vs.-les-fonctions-de-base" class="title-slide slide level1 center">
<h1>Avantages de <strong><em>readr</em></strong> <em>vs.</em> les fonctions de base</h1>

</section>
<section id="pour-les-gros-fichiers-readr-est-plus-rapide" class="slide level2">
<h2>Pour les gros fichiers, <strong><em>readr</em></strong> est plus rapide</h2>
<ul>
<li>Lecture du fichier biomasse avec la fonction <code>read.csv</code> de base</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>debut <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb18-2"><a href="#cb18-2"></a>fish1 <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"./data/global_reef_fish_biomass.csv"</span>, </span>
<span id="cb18-3"><a href="#cb18-3"></a>                   <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>fin <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"L'import a duré : "</span>,</span>
<span id="cb18-6"><a href="#cb18-6"></a>            fin<span class="sc">-</span>debut, <span class="st">"secondes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Lecture du même fichier avec <code>read_csv</code> de la librairie <strong>readr</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>debut <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-2"><a href="#cb19-2"></a>fish2 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>, </span>
<span id="cb19-3"><a href="#cb19-3"></a>                    <span class="at">delim =</span> <span class="st">","</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>fin <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"L'import a duré : "</span>,</span>
<span id="cb19-6"><a href="#cb19-6"></a>            fin<span class="sc">-</span>debut, <span class="st">"secondes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read_csv-permet-de-lire-depuis-une-archive-ce-que-ne-permet-pas-read.csv" class="slide level2">
<h2><code>read_csv</code> permet de lire depuis une archive, ce que ne permet pas <code>read.csv</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>survey_metadata_zip <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.zip"</span>,</span>
<span id="cb20-2"><a href="#cb20-2"></a>                                  <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb20-3"><a href="#cb20-3"></a>                                  <span class="at">skip =</span> <span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read_csv-permet-de-lire-depuis-plusieurs-fichiers-et-mêmes-répertoires" class="slide level2">
<h2><code>read_csv</code> permet de lire depuis plusieurs fichiers et mêmes répertoires</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"africa"</span>, <span class="st">"americas"</span>, <span class="st">"asia"</span>, <span class="st">"europe"</span>, <span class="st">"oceania"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>filepaths <span class="ot">&lt;-</span> <span class="fu">vapply</span>(</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">paste0</span>(<span class="st">"mini-gapminder-"</span>, continents, <span class="st">".csv"</span>),</span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="at">FUN =</span> readr_example,</span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="at">FUN.VALUE =</span> <span class="fu">character</span>(<span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>)</span>
<span id="cb21-7"><a href="#cb21-7"></a>conti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(filepaths, <span class="at">id =</span> <span class="st">"file"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-sélection-de-colonnes-lors-de-la-lecture-avec-read_csv-est-facilitée" class="slide level2">
<h2>La sélection de colonnes lors de la lecture avec <code>read_csv</code> est facilitée</h2>
<ul>
<li>Par nom de colonne</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>survey_metadata_1 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb22-2"><a href="#cb22-2"></a>                                <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>                                <span class="at">skip =</span> <span class="dv">70</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                                <span class="at">col_select =</span> <span class="fu">c</span>(survey_id,country, site_code, site_name))</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="fu">head</span>(survey_metadata_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-sélection-de-colonnes-lors-de-la-lecture-avec-read_csv-est-facilitée-1" class="slide level2">
<h2>La sélection de colonnes lors de la lecture avec <code>read_csv</code> est facilitée</h2>
<ul>
<li>Par numéro de colonne</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>survey_metadata_2 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb23-2"><a href="#cb23-2"></a>                                <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb23-3"><a href="#cb23-3"></a>                                <span class="at">skip =</span> <span class="dv">70</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>                                <span class="at">col_select =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>))</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">head</span>(survey_metadata_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-sélection-de-colonnes-lors-de-la-lecture-avec-read_csv-est-facilitée-2" class="slide level2">
<h2>La sélection de colonnes lors de la lecture avec <code>read_csv</code> est facilitée</h2>
<ul>
<li>Par numéro de colonne, en omettant certaines colonnes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>survey_metadata_3 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb24-2"><a href="#cb24-2"></a>                                <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>                                <span class="at">skip =</span> <span class="dv">70</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>                                <span class="at">col_select =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">22</span>,<span class="dv">24</span>))</span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="fu">head</span>(survey_metadata_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="on-peut-renommer-certaines-colonnes" class="slide level2">
<h2>On peut renommer certaines colonnes</h2>
<p>NB : ne pas oublier <code>everything()</code> pour conserver à l’identique toutes les colonnes non renommées</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>survey_metadata_4 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb25-2"><a href="#cb25-2"></a>                                <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb25-3"><a href="#cb25-3"></a>                                <span class="at">skip =</span> <span class="dv">70</span>,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                                <span class="at">col_select =</span> <span class="fu">c</span>(<span class="at">projet =</span> survey_id, <span class="at">pays =</span> country, <span class="fu">everything</span>()))</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="fu">head</span>(survey_metadata_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="on-peut-faire-un-filtre-en-entrée-sur-les-valeurs-dune-colonne-avec-read_..._chunked" class="slide level2">
<h2>On peut faire un filtre en entrée sur les valeurs d’une colonne avec <code>read_..._chunked</code></h2>
<ul>
<li>Pour sélectionner sur une colonne (ici la famille)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, pos) <span class="fu">subset</span>(x, family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Kyphosidae"</span>, <span class="st">"Labridae"</span>, <span class="st">"Sparidae"</span>))</span>
<span id="cb26-2"><a href="#cb26-2"></a>kyphosidae_labridae_sparidae_biomass <span class="ot">&lt;-</span> <span class="fu">read_csv_chunked</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>, </span>
<span id="cb26-3"><a href="#cb26-3"></a>                               <span class="at">callback =</span> DataFrameCallback<span class="sc">$</span><span class="fu">new</span>(f1), </span>
<span id="cb26-4"><a href="#cb26-4"></a>                               <span class="at">chunk_size =</span> <span class="dv">1000</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="fu">table</span>(kyphosidae_labridae_sparidae_biomass<span class="sc">$</span>family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="on-peut-faire-un-filtre-en-entrée-sur-les-valeurs-dune-colonne-avec-read_..._chunked-1" class="slide level2">
<h2>On peut faire un filtre en entrée sur les valeurs d’une colonne avec <code>read_..._chunked</code></h2>
<ul>
<li>Pour sélectionner sur plusieurs colonnes (ici la famille et la classe de taille)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, pos) <span class="fu">subset</span>(x, family <span class="sc">==</span> <span class="st">"Kyphosidae"</span> <span class="sc">&amp;</span> size_class<span class="sc">&gt;</span><span class="dv">9</span> <span class="sc">&amp;</span> size_class <span class="sc">&lt;</span> <span class="dv">31</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>kyphosidae_10_30_cm_biomass <span class="ot">&lt;-</span> <span class="fu">read_csv_chunked</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>, </span>
<span id="cb27-3"><a href="#cb27-3"></a>                                       <span class="at">callback =</span> DataFrameCallback<span class="sc">$</span><span class="fu">new</span>(f2), </span>
<span id="cb27-4"><a href="#cb27-4"></a>                                       <span class="at">chunk_size =</span> <span class="dv">1000</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="fu">table</span>(kyphosidae_10_30_cm_biomass<span class="sc">$</span>family, kyphosidae_10_30_cm_biomass<span class="sc">$</span>size_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-1.1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 1.1</h2>
<ul>
<li>Lire le fichier Survey_metadata.csv =&gt; tibble <code>survey_metadata</code>,</li>
<li>Lire le fichier Global_reef_fish_biomass.csv =&gt; tibble <code>global_reef_fish_biomass</code></li>
<li>Lire le fichier Global_reef_fish_abundance.csv =&gt; tibble <code>global_reef_fish_abundance</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb28-1" class="hljs-ln-code"><a href="#cb28-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-1.1-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 1.1 corrigé</h2>
<ul>
<li>Lire le fichier Survey_metadata.csv =&gt; tibble <code>survey_metadata</code>,</li>
<li>Lire le fichier Global_reef_fish_biomass.csv =&gt; tibble <code>global_reef_fish_biomass</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb29-1" class="hljs-ln-code"><a href="#cb29-1"></a><span class="co"># solution</span></span>
<span id="cb29-2" class="hljs-ln-code"><a href="#cb29-2"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./data/global_reef_fish_biomass.csv"</span>)</span>
<span id="cb29-3" class="hljs-ln-code"><a href="#cb29-3"></a>survey_metadata <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>,</span>
<span id="cb29-4" class="hljs-ln-code"><a href="#cb29-4"></a>                              <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb29-5" class="hljs-ln-code"><a href="#cb29-5"></a>                              <span class="at">skip =</span> <span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-1.2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 1.2</h2>
<p>Lire le fichier Survey_metadata.csv =&gt; tibble <code>Survey_selection</code> en sélectionnant le pays=Indonésie, la profondeur inférieure à 20m et la visibilité supérieure à 10m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb30-1" class="hljs-ln-code"><a href="#cb30-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-1.2-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 1.2 corrigé</h2>
<p>Lire le fichier Survey_metadata.csv =&gt; tibble <code>Survey_selection</code> en sélectionnant le pays Indonésie, la profondeur inférieure à 20m et la visibilité supérieure à 10m.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb31-1" class="hljs-ln-code"><a href="#cb31-1"></a><span class="co"># solution</span></span>
<span id="cb31-2" class="hljs-ln-code"><a href="#cb31-2"></a>f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, pos) <span class="fu">subset</span>(x, country <span class="sc">==</span> <span class="st">"Indonesia"</span> <span class="sc">&amp;</span> depth<span class="sc">&lt;</span><span class="dv">20</span> <span class="sc">&amp;</span> visibility<span class="sc">&gt;</span><span class="dv">10</span> )</span>
<span id="cb31-3" class="hljs-ln-code"><a href="#cb31-3"></a>survey_selection <span class="ot">&lt;-</span> <span class="fu">read_delim_chunked</span>(<span class="at">file =</span> <span class="st">"./data/survey_metadata.csv"</span>, </span>
<span id="cb31-4" class="hljs-ln-code"><a href="#cb31-4"></a>                                       <span class="at">callback =</span> DataFrameCallback<span class="sc">$</span><span class="fu">new</span>(f3), </span>
<span id="cb31-5" class="hljs-ln-code"><a href="#cb31-5"></a>                                       <span class="at">chunk_size =</span> <span class="dv">1000</span>,</span>
<span id="cb31-6" class="hljs-ln-code"><a href="#cb31-6"></a>                                       <span class="at">delim =</span> <span class="st">";"</span>,</span>
<span id="cb31-7" class="hljs-ln-code"><a href="#cb31-7"></a>                                       <span class="at">skip =</span> <span class="dv">70</span>)</span>
<span id="cb31-8" class="hljs-ln-code"><a href="#cb31-8"></a><span class="fu">dim</span>(survey_selection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="partie-2-manipulation-de-données-avec-dplyr" class="title-slide slide level1 center">
<h1>Partie 2 : Manipulation de données avec dplyr</h1>

<img data-src="images/dplyr_logo.png" class="r-stretch"></section>
<section id="dplyr" class="slide level2">
<h2><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></h2>
<h3 id="pourquoi-utiliser-dplyr-et-sa-syntaxe">Pourquoi utiliser dplyr et sa syntaxe ?</h3>
<ul>
<li>Syntaxe claire et cohérente
<ul>
<li>“lien” avec le SQL</li>
<li>deux “familles” de fonctions : résumé et vectorisation <br> <br> <br> <img data-src="images/summary_function.png" class="absolute" style="top: 320px; left: 15px; "> <img data-src="images/vectorized_function.png" class="absolute" style="top: 320px; right: 15px; "></li>
</ul></li>
<li>Utilisation de verbes</li>
<li>Généralement plus rapides que leur équivalent sous R de base</li>
<li>Permet d’enchainer les opérations avec des “pipes” <img data-src="images/pipe.png" class="absolute" style="top: 450px; right: 20px; width: 15%; "></li>
</ul>
</section>
<section id="manipulation-des-lignes" class="slide level2">
<h2>Manipulation des lignes</h2>
<h3 id="manipulation-de-type-extraction">Manipulation de type extraction</h3>
<p>Type de fonctions qui retournent un sous-ensemble de lignes</p>
<ul>
<li>Extraction d’une ou plusieurs lignes : fonctions de la famille slice &amp; co</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># sélection d'une ou plusieurs lignes par position absolue</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="fu">slice</span>()</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co"># sélection au hasard d'un nombre de lignes ou d'une proportion du jeu de données</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="fu">slice_sample</span>()</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co"># sélection des n dernières lignes</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="fu">slice_tail</span>()</span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co"># sélection des n premières lignes</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="fu">slice_head</span>()</span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co"># sélection des valeurs distinctes</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="fu">distinct</span>()</span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="co"># sélection en fonction d'opérateurs logiques et/ou booléens</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="fu">filter</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="petit-focus-sur-les-opérateurs-booléens-et-logiques" class="slide level2 smaller">
<h2>Petit focus sur les opérateurs booléens et logiques</h2>
<p>Renvoient une valeur TRUE ou FALSE</p>
<ul>
<li>les communs :</li>
</ul>
<p><img data-src="images/booleens.png"></p>
<ul>
<li>certains plus particuliers :</li>
</ul>
<p><img data-src="images/booleens_particulier.png" style="width:25.0%"></p>
<ul>
<li>Attention aux priorités dans les interprétations
<ul>
<li>&amp; est plus fort que |, il sera exécuté en premier</li>
<li>une solution est d’utiliser des () pour séparer vos opérateurs</li>
</ul></li>
</ul>
</section>
<section id="exercice-2.1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.1</h2>
<ul>
<li>A l’aide d’une fonction dplyr, vérifier s’il y a des données dupliquées dans le jeu de données “global_reef_fish_biomass”</li>
<li>En une seule fois, selectionner les données dont la variable “biomass” est différent de 0, où la famille de l’espèce est différente de “Mullidae” et “Apogonidae” et pour finir où la classe de taille associée est &lt;= 10.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb33-1" class="hljs-ln-code"><a href="#cb33-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.1-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.1 corrigé</h2>
<ul>
<li>A l’aide d’une fonction dplyr, vérifier s’il y a des données dupliquées dans le jeu de données “global_reef_fish_biomass”</li>
<li>En une seule fois, selectionner les données dont la variable “total” est différent de 0, où la famille de l’espèce est différente de “Mullidae” ou “Apogonidae” et pour finir où la classe de taille associée est &lt;= 10.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb34-1" class="hljs-ln-code"><a href="#cb34-1"></a><span class="co"># solution</span></span>
<span id="cb34-2" class="hljs-ln-code"><a href="#cb34-2"></a>biomass_exercice2_1_distinct <span class="ot">&lt;-</span> <span class="fu">distinct</span>(<span class="at">.data =</span> global_reef_fish_biomass)</span>
<span id="cb34-3" class="hljs-ln-code"><a href="#cb34-3"></a>biomass_exercice2_1_filter <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">.data =</span> biomass_exercice2_1_distinct,</span>
<span id="cb34-4" class="hljs-ln-code"><a href="#cb34-4"></a>                                     biomass <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb34-5" class="hljs-ln-code"><a href="#cb34-5"></a>                                     <span class="sc">&amp;</span> <span class="sc">!</span> family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mullidae"</span>,</span>
<span id="cb34-6" class="hljs-ln-code"><a href="#cb34-6"></a>                                                       <span class="st">"Apogonidae"</span>)</span>
<span id="cb34-7" class="hljs-ln-code"><a href="#cb34-7"></a>                                     <span class="sc">&amp;</span> size_class <span class="sc">&lt;=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="amélioration-de-la-lisibilité-du-code" class="slide level2">
<h2>Amélioration de la lisibilité du code</h2>
<p>Ici on a effectué 2 opérations, mais on peut imaginer en faire beaucoup plus dans la réalité.</p>
<p>Grâce à la syntaxe de dplyr, on peut répondre à ce besoin de deux manières différentes.</p>
<p>La première est d’effectuer toutes les opérations en une fois en les emboîtant :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>biomass_exercice2_1_distinct_filter <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">.data =</span> <span class="fu">distinct</span>(<span class="at">.data =</span> global_reef_fish_biomass),</span>
<span id="cb35-2"><a href="#cb35-2"></a>                                              biomass <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>                                              <span class="sc">&amp;</span> <span class="sc">!</span> family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mullidae"</span>,</span>
<span id="cb35-4"><a href="#cb35-4"></a>                                                                <span class="st">"Apogonidae"</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a>                                              <span class="sc">&amp;</span> size_class <span class="sc">&lt;=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cependant cela a plusieurs inconvénients. La structure est peu lisible, les opérations apparaissent dans l’ordre inverse de leur réalisation et il est difficile de voir quel paramètre se rapporte à quelle fonction.</p>
</section>
<section id="aller-encore-plus-loin" class="slide level2">
<h2>Aller encore plus loin</h2>
<h3 id="utilisation-dun-nouvelle-opérateur-baptisé-pipe">Utilisation d’un nouvelle opérateur baptisé <a href="https://magrittr.tidyverse.org/" target="_blank">pipe</a></h3>
<ul>
<li><p>Il se note %&gt;%</p></li>
<li><p>Son fonctionnement est le suivant : si j’exécute expr %&gt;% f, le résultat de l’expression expr, à gauche du pipe, sera passé comme premier argument à la fonction f, à droite du pipe, ce qui revient à exécuter f(expr)</p></li>
<li><p>L’intérêt est que l’on peut enchainer plusieurs pipes</p></li>
<li><p>Avec notre exemple précédent cela donne :</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>biomass_exercice2_1_distinct_filter <span class="ot">&lt;-</span> <span class="fu">distinct</span>(<span class="at">.data =</span> global_reef_fish_biomass) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">filter</span>(biomass <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>         <span class="sc">&amp;</span> <span class="sc">!</span> family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mullidae"</span>,</span>
<span id="cb36-4"><a href="#cb36-4"></a>                           <span class="st">"Apogonidae"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>         <span class="sc">&amp;</span> size_class <span class="sc">&lt;=</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="encore-quelques-fonctions-de-manipulation-de-lignes" class="slide level2">
<h2>Encore quelques fonctions de manipulation de lignes</h2>
<h3 id="manipulation-de-type-tri">Manipulation de type “tri”</h3>
<ul>
<li>Ordonner les lignes d’une ou plusieurs colonnes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># par défaut ordre croissant, utiliser l'argument desc pour ordre décroissant</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">arrange</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<h3 id="manipulation-de-type-ajout">Manipulation de type “ajout”</h3>
<ul>
<li>Ajouter une ligne dans un jeu de données</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># interet des arguments .before and .after</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">add_row</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="manipulation-des-variables" class="slide level2">
<h2>Manipulation des variables</h2>
<h3 id="extraction-dune-ou-plusieurs-colonnes">Extraction d’une ou plusieurs colonnes</h3>
<p>Type de fonctions qui retournent un sous-ensemble de colonnes sous la forme d’un vecteur ou d’une table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># extraction des valeurs d'une colonne sous la forme d'un vecteur</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co"># on peut utiliser des noms ou les ids</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">pull</span>()</span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co"># extraction d'une colonne sous la forme d'une table</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co"># bien regarder les arguments de la fonction car on peut faire beaucoup</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="fu">select</span>()</span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co"># Changer l'ordre ou la place d'une ou plusieurs colonnes</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="co"># ne pas oublier les arguments .after et .before</span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="fu">relocate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fonctions-de-vectorisation" class="slide level2">
<h2>Fonctions de vectorisation</h2>
<h3 id="une-des-deux-grandes-familles-de-fonction-avec-dplyr">Une des deux grandes familles de fonction avec dplyr</h3>
<ul>
<li><p>On a commencé à l’aborder de manière instinctive avec relocate()</p></li>
<li><p>Globalement, ce sont des fonctions qui ont un vecteur en entrée et retournent un vecteur de la même taille en sortie <br> <br> <br> <img data-src="images/vectorized_function.png" class="absolute" style="top: 300px; left: 250px; width: 50%; "></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># créer une nouvelle variable</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">mutate</span>()</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co"># créer une nouvelle variable mais sans conserver les anciennes</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="fu">transmute</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Petit bonus pour renommer les variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">rename</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.2" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.2</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 1</li>
<li>Créer une variable “survey_id_full” qui est la concaténation des variables survey_id, species_name et size_class</li>
<li>Placer cette nouvelle colonne avant la colonne survey_id</li>
<li>Supprimer la quatrième colonne du jeu de données (utiliser son indice) ainsi que la colonne reporting_name</li>
<li>Renommer la variable size_class en size_class_cm</li>
<li>Créer une nouvelle variable size_class_mm qui convertit la variable size_class_cm en mm</li>
<li>Supprimer la variable size_class_cm</li>
<li>Trier par ordre décroissant les données en fonction de la variable size_class_mm</li>
<li>Utiliser des pipes à la fin pour avoir une syntaxe “propre” et souffler un bon coup :)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb42-1" class="hljs-ln-code"><a href="#cb42-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.2-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.2 corrigé</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 1</li>
<li>Créer une variable “survey_id_full” qui est la concaténation des variables survey_id, species_name et size_class</li>
<li>Placer cette nouvelle colonne avant la colonne survey_id</li>
<li>Supprimer la quatrième colonne du jeu de données (utiliser son indice) ainsi que la colonne reporting_name</li>
<li>Renommer la variable size_class en size_class_cm</li>
<li>Créer une nouvelle variable size_class_mm qui convertit la variable size_class_cm en mm</li>
<li>Supprimer la variable size_class_cm</li>
<li>Trier par ordre décroissant les données en fonction de la variable size_class_mm</li>
<li>Utiliser des pipes à la fin pour avoir une syntaxe “propre” et souffler un bon coup :)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb43-1" class="hljs-ln-code"><a href="#cb43-1"></a><span class="co"># solution</span></span>
<span id="cb43-2" class="hljs-ln-code"><a href="#cb43-2"></a>biomass_exercice2_2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(<span class="at">.data =</span> biomass_exercice2_1_distinct_filter,</span>
<span id="cb43-3" class="hljs-ln-code"><a href="#cb43-3"></a>                              <span class="at">survey_id_full =</span> <span class="fu">paste</span>(survey_id,</span>
<span id="cb43-4" class="hljs-ln-code"><a href="#cb43-4"></a>                                                     species_name,</span>
<span id="cb43-5" class="hljs-ln-code"><a href="#cb43-5"></a>                                                     size_class,</span>
<span id="cb43-6" class="hljs-ln-code"><a href="#cb43-6"></a>                                                     <span class="at">sep =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-7" class="hljs-ln-code"><a href="#cb43-7"></a>  <span class="fu">relocate</span>(survey_id_full,</span>
<span id="cb43-8" class="hljs-ln-code"><a href="#cb43-8"></a>           <span class="at">.before =</span> survey_id) <span class="sc">%&gt;%</span></span>
<span id="cb43-9" class="hljs-ln-code"><a href="#cb43-9"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb43-10" class="hljs-ln-code"><a href="#cb43-10"></a>                <span class="sc">-</span>reporting_name) <span class="sc">%&gt;%</span></span>
<span id="cb43-11" class="hljs-ln-code"><a href="#cb43-11"></a>  <span class="fu">rename</span>(<span class="at">size_class_cm =</span> size_class) <span class="sc">%&gt;%</span></span>
<span id="cb43-12" class="hljs-ln-code"><a href="#cb43-12"></a>  <span class="fu">mutate</span>(<span class="at">size_class_mm =</span> size_class_cm <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-13" class="hljs-ln-code"><a href="#cb43-13"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>size_class_cm) <span class="sc">%&gt;%</span></span>
<span id="cb43-14" class="hljs-ln-code"><a href="#cb43-14"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(size_class_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fonctions-de-resumé" class="slide level2 smaller">
<h2>Fonctions de resumé</h2>
<h3 id="la-deuxième-grande-famille">La deuxième grande famille</h3>
<ul>
<li><p>Fonctions qui vont créer une nouvelle table avec des resumés statistiques. De manière globale, les fonctions associées vont utiliser en entrée des vecteurs et en sortie une ou plusieurs valeurs ( en nombre inférieur au nombre de vecteurs d’entrée) <br> <br> <br> <img data-src="images/summary_function.png" class="absolute" style="top: 200px; left: 250px; width: 50%; "></p></li>
<li><p>Fonction clé</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">summarise</span>()</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co"># Beaucoup, beaucoup d'options et de possibilités</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co"># Compter le nombre de valeurs/lignes</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">n</span>()</span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co"># Compter le nombre de valeurs/lignes distinctes</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="fu">n_distinct</span>()</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># Faire une moyenne</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="fu">mean</span>()</span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co"># Faire une somme, option na.rm disponible</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="fu">sum</span>()</span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co"># Utiliser des notions de position</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="fu">first</span>()</span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="fu">last</span>()</span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="co"># Ou de rang</span></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="fu">quantile</span>()</span>
<span id="cb44-16"><a href="#cb44-16"></a><span class="fu">min</span>()</span>
<span id="cb44-17"><a href="#cb44-17"></a><span class="fu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction-à-la-notion-de-groupe" class="slide level2">
<h2>Introduction à la notion de groupe</h2>
<ul>
<li><p>Pour le moment on a fait des opérations sur l’ensemble du jeu de données, pas très pertinent non ?</p></li>
<li><p>Fonction de création de groupe</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># on peut définir nos groupes en fonction des modalités des variables</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">group_by</span>()</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co"># ou alors en isolant chaque ligne</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="fu">rowwise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Attention à ce que vous faites ! Par défaut, les groupes sont gardés en mémoire dans votre jeu de données de sortie (lisez les messages de R). Pour y remédier :</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># via un summarise (argument experimental, attention à la pérennité)</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>.groups</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co"># de manière plus générale</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="fu">ungroups</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Cette notion de groupe peut être utilisée avec d’autres fonctions (comme un mutate)</li>
</ul>
</section>
<section id="exercice-2.3" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.3</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 2</li>
<li>Effectuer la somme de la biomasse (variable biomass) en fonction de la variable survey_id_full créée précédemment</li>
<li>Pour survey_id_full répétés, ne garder que la première ligne de chaque répétition. Attention à bien conserver toutes les colonnes associées (une fois la fonction “trouvée” regarder du côté des arguments en option)</li>
<li>Créer un nouveau jeu de données qui exprime le nombre d’échantillons disponibles par famille et vérifier la cohérence du nombre total obtenu avec le jeu de données de départ.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb47-1" class="hljs-ln-code"><a href="#cb47-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.3-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.3 corrigé</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 2</li>
<li>Effectuer la somme de la biomasse (variable biomass) en fonction de la variable survey_id_full créée précédemment</li>
<li>Pour survey_id_full répétés, ne garder que la première ligne de chaque répétition. Attention à bien conserver toutes les colonnes associées (une fois la fonction “trouvée” regarder du côté des arguments en option)</li>
<li>Créer un nouveau jeu de données qui exprime le nombre d’échantillons disponibles par famille et vérifier la cohérence du nombre total obtenu avec le jeu de données de départ.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb48-1" class="hljs-ln-code"><a href="#cb48-1"></a><span class="co"># solution</span></span>
<span id="cb48-2" class="hljs-ln-code"><a href="#cb48-2"></a>biomass_exercice2_3 <span class="ot">&lt;-</span> biomass_exercice2_2 <span class="sc">%&gt;%</span></span>
<span id="cb48-3" class="hljs-ln-code"><a href="#cb48-3"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(survey_id_full) <span class="sc">%&gt;%</span></span>
<span id="cb48-4" class="hljs-ln-code"><a href="#cb48-4"></a>  <span class="fu">mutate</span>(<span class="at">sum_biomass =</span> <span class="fu">sum</span>(<span class="at">x =</span> biomass)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5" class="hljs-ln-code"><a href="#cb48-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-6" class="hljs-ln-code"><a href="#cb48-6"></a>  <span class="fu">distinct</span>(survey_id_full,</span>
<span id="cb48-7" class="hljs-ln-code"><a href="#cb48-7"></a>           <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-8" class="hljs-ln-code"><a href="#cb48-8"></a>biomass_exercice2_3_sample_verification <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="at">.data =</span> biomass_exercice2_2,</span>
<span id="cb48-9" class="hljs-ln-code"><a href="#cb48-9"></a>                                                           family) <span class="sc">%&gt;%</span></span>
<span id="cb48-10" class="hljs-ln-code"><a href="#cb48-10"></a>  <span class="fu">summarise</span>(<span class="at">nb_sample_family =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb48-11" class="hljs-ln-code"><a href="#cb48-11"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(nb_sample_family))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fonction-bonus-très-utile" class="slide level2 smaller">
<h2>Fonction bonus très utile</h2>
<h3 id="case_when-généralisation-vectorisée-de-ifs">case_when : généralisation vectorisée de if(s)</h3>
<ul>
<li>Vectorisation de multiples if_else sous R et CASE WHEN en SQL</li>
<li>Améliore grandement la lisibilité de vos fonctions</li>
<li>Syntaxe de base :</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">case_when</span>(</span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">operateur</span>(s) booléen(s) ou <span class="fu">logique</span>(s) <span class="sc">~</span> output1,</span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">operateur</span>(s) booléen(s) ou <span class="fu">logique</span>(s) <span class="sc">~</span> output2,</span>
<span id="cb49-4"><a href="#cb49-4"></a>  ....</span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">operateur</span>(s) booléen(s) ou <span class="fu">logique</span>(s) <span class="sc">~</span> output_n,</span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> output si rien ne marche au dessus</span>
<span id="cb49-7"><a href="#cb49-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Pensez bien à toujours mettre un TRUE (=valeur par défaut)</li>
<li>Attention à ne pas mélanger les types, il existe différents NA :
<ul>
<li>NA_integer_</li>
<li>NA_real_</li>
<li>NA_complex_</li>
<li>NA_character_</li>
</ul></li>
</ul>
</section>
<section id="combinaison-de-jeux-de-données-1" class="slide level2">
<h2>Combinaison de jeux de données 1</h2>
<h3 id="jointures-simples">Jointures “simples”</h3>
<ul>
<li>Il doit y avoir une cohérence entre le nombre de colonnes ou de lignes</li>
<li>Attention, aucune vérification de cohérence des jointures</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># "Coller" deux jeux de données</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">bind_cols</span>()</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combinaison-de-jeux-de-données-2" class="slide level2 smaller">
<h2>Combinaison de jeux de données 2</h2>
<h3 id="jointures-de-type-relationnel">Jointures de type relationnel</h3>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>Très proche du SQL</li>
<li>Très puissantes et permettent de se poser les bonnes questions !</li>
<li>Attention à bien spécifier l’argument by (ne pas laisser place à l’interprétation !)
<ul>
<li>On peut spécifier une seule ou plusieurs colonnes si les noms sont identiques entre les deux jeux de données</li>
<li>Sinon on spécifie le nom du jeu de données à “gauche” et celui qui est à “droite”</li>
</ul></li>
</ul>
</div><div class="column" style="width:30%;">
<p><img data-src="images/jointure.png"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># jointure à gauche</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">left_join</span>()</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="co"># jointure à droite</span></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="fu">right_join</span>()</span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="co"># jointure commune</span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="fu">inner_join</span>()</span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="co"># jointure complete</span></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="fu">full_join</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.4" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.4</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 2.3 (biomass_exercice2_3)</li>
<li>Faire la “meilleure” jointure avec le jeu de données survey_metadata et expliquer votre choix</li>
<li>Pour vous aider :
<ul>
<li>Y-a-t-il un problème avec le jeu de données survey_metadata ?</li>
<li>Réfléchissez en termes du nombre de lignes obtenues pour chaque fonction de jointure</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb52-1" class="hljs-ln-code"><a href="#cb52-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-2.4-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 2.4 corrigé</h2>
<ul>
<li>À partir du jeu de données de sortie de l’exercice 2.3 (biomass_exercice2_3)</li>
<li>Faire la “meilleure” jointure avec le jeu de données survey_metadata et expliquer votre choix</li>
<li>Pour vous aider :
<ul>
<li>Y-a-t-il un problème avec le jeu de données survey_metadata ?</li>
<li>Réfléchissez en termes du nombre de lignes obtenues pour chaque fonction de jointure</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb53-1" class="hljs-ln-code"><a href="#cb53-1"></a><span class="co"># solution</span></span>
<span id="cb53-2" class="hljs-ln-code"><a href="#cb53-2"></a>survey_metadata_distinct <span class="ot">&lt;-</span> <span class="fu">distinct</span>(<span class="at">.data =</span> survey_metadata)</span>
<span id="cb53-3" class="hljs-ln-code"><a href="#cb53-3"></a>biomass_survey_exercice2_4 <span class="ot">&lt;-</span> biomass_exercice2_3 <span class="sc">%&gt;%</span></span>
<span id="cb53-4" class="hljs-ln-code"><a href="#cb53-4"></a>  <span class="fu">left_join</span>(survey_metadata_distinct,</span>
<span id="cb53-5" class="hljs-ln-code"><a href="#cb53-5"></a>             <span class="at">by =</span> <span class="st">"survey_id"</span>)</span>
<span id="cb53-6" class="hljs-ln-code"><a href="#cb53-6"></a><span class="fu">save</span>(biomass_survey_exercice2_4, <span class="at">file =</span> <span class="st">"./data/biomass_survey_exercice2_4.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="partie-3-nettoyage-des-données-avec-tidyr" class="title-slide slide level1 center">
<h1>Partie 3 : Nettoyage des données avec <code>tidyr</code></h1>
<center>
<p><img data-src="images/logo_tidyr.png" style="width:20.0%"></p>
<center>
</center></center></section>
<section id="tidyr" class="slide level2">
<h2>Tidyr</h2>
<p>L’objectif du package tidyr est de fournir des fonctions pour arranger et nettoyer ses données dans le but de les convertir dans un format “tidy”</p>
<p>Les différents verbes viennent s’ajouter à tous ceux que nous avons déjà vus avec <code>readr</code> et <code>dplyr</code> et ils s’intègrent parfaitement dans la série de pipe %&gt;% permettant d’enchainer les opérations</p>
<ul>
<li><p>Les données “tidy”, qu’est ce que c’est?</p>
<ul>
<li><p>1 variable = 1 colonne</p></li>
<li><p>1 observation = 1 ligne/case</p></li>
<li><p>1 type d’observation par table</p></li>
</ul></li>
</ul>
<p>Pour visualiser le cheatsheet <code>tidyr</code> <a href="https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf">cliquez ici</a></p>
</section>
<section id="tidyr-1" class="slide level2">
<h2>Tidyr</h2>
<p>Pour illustrer cette partie nous utiliserons le jeu de données popEU qui décrit le nombre d’habitants par pays pour les années 2014, 2015 et 2016</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>popEU <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/popEU.RDS"</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">slice_tail</span>(popEU)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:right;"> year </th>
   <th style="text-align:right;"> pop </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:right;"> 2016 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:right;"> 2014 </td>
   <td style="text-align:right;"> 80.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:right;"> 2015 </td>
   <td style="text-align:right;"> 81.69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:right;"> 2016 </td>
   <td style="text-align:right;"> 82.35 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="les-principales-fonctions-de-tidyr" class="slide level2">
<h2>Les principales fonctions de tidyr</h2>
<h3 id="modelage-des-tableaux">Modelage des tableaux</h3>
<p><code>pivot_wider()</code>et <code>pivot_longer()</code>sont les successeurs des fonctions en base R du package <code>reshape</code> puis <code>reshape2</code>. Et se nommaient <code>spread()</code>et <code>gather()</code> dans les premières versions de <code>tidyr</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a> <span class="co"># Transformer un tableau long en format large</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">pivot_wider</span>(names_from, values_from)</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="co"># Transformer un tableau large en format long</span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="fu">pivot_longer</span>(cols, names_to, values_to, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---pivot_wider">Applications - pivot_wider</h3>
<p>Transformer le jeu de données en format “wide” en utilisant la fonction <code>pivot_wider()</code>. Nous voulons obtenir une colonne par année</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Créer un nouvel objet que l'on nomme popEU_wide</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>popEU_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(popEU, <span class="at">names_from =</span> <span class="st">"year"</span>, <span class="at">values_from =</span> <span class="st">"pop"</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>popEU_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:right;"> 2014 </th>
   <th style="text-align:right;"> 2015 </th>
   <th style="text-align:right;"> 2016 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:right;"> 66.13 </td>
   <td style="text-align:right;"> 66.422 </td>
   <td style="text-align:right;"> 66.602 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:right;"> 46.48 </td>
   <td style="text-align:right;"> 46.440 </td>
   <td style="text-align:right;"> 46.480 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Italie </td>
   <td style="text-align:right;"> 60.79 </td>
   <td style="text-align:right;"> 60.730 </td>
   <td style="text-align:right;"> 60.630 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:right;"> 11.21 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:right;"> 80.98 </td>
   <td style="text-align:right;"> 81.690 </td>
   <td style="text-align:right;"> 82.350 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<h3 id="gestion-des-valeurs-manquantes-na">Gestion des valeurs manquantes “NA”</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># Remplacer des "NA" par des valeurs spécifiques</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="fu">replace_na</span>(data, replace, …)</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># Supprimer les lignes contenant des "NA"</span></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="fu">drop_na</span>(data, …)</span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="co">#  Remplir les "NA" en utilisant les valeurs précédentes ou suivantes de la même colonne</span></span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="fu">fill</span>(data, …, .direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---pivot_longerreplace_na">Applications - pivot_longer/replace_na</h3>
<p>Re-transformer le jeu de données en format “long” en utilisant la fonction <code>pivot_longer()</code> et remplacer les valeurs de NA dans la colonne “pop”, par la population moyenne de la Belgique pour ces 2 années (11,27 M)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># Créer un nouvel objet que l'on nomme popEU_long</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>popEU_long <span class="ot">&lt;-</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb58-4"><a href="#cb58-4"></a>    popEU_wide,</span>
<span id="cb58-5"><a href="#cb58-5"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb58-6"><a href="#cb58-6"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb58-7"><a href="#cb58-7"></a>    <span class="at">values_to =</span> <span class="st">"pop"</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>  )</span>
<span id="cb58-9"><a href="#cb58-9"></a>popEU_long <span class="ot">&lt;-</span> <span class="fu">mutate</span>(popEU_long, <span class="at">pop =</span> <span class="fu">replace_na</span>(pop, <span class="fl">11.27</span>))</span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="fu">slice_tail</span>(popEU_long, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> year </th>
   <th style="text-align:right;"> pop </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 11.27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 11.27 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 80.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 81.69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 82.35 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---pivot_longerdrop_na">Applications - pivot_longer/drop_na</h3>
<p>Re-transformer le jeu de données en format “long” en utilisant la fonction `pivot_longer()` et supprimer les lignes contenant des NA dans la colonne pop. Essayer d’enchainer les opérations à l’aide du pipe %&gt;%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Créer un nouvel objet que l'on nomme popEU_long</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>popEU_long <span class="ot">&lt;-</span> popEU_wide <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">pivot_longer</span>(.,</span>
<span id="cb59-4"><a href="#cb59-4"></a>               <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb59-5"><a href="#cb59-5"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb59-6"><a href="#cb59-6"></a>               <span class="at">values_to =</span> <span class="st">"pop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>  <span class="fu">drop_na</span>(., pop)</span>
<span id="cb59-8"><a href="#cb59-8"></a><span class="fu">slice_tail</span>(popEU_long, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> year </th>
   <th style="text-align:right;"> pop </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Italie </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 60.73 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Italie </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 60.63 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 80.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 81.69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 82.35 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-5" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---pivot_longerfill">Applications - pivot_longer/fill</h3>
<p>Re-transformer le jeu de données en format “long” en utilisant la fonction `pivot_longer()` et compléter les valeurs manquantes par la valeur du pays correspondant. Essayer d’enchainer les opérations à l’aide du pipe %&gt;%</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Créer un nouvel objet que l'on nomme popEU_long</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>popEU_long <span class="ot">&lt;-</span> popEU_wide <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">pivot_longer</span>(.,</span>
<span id="cb60-4"><a href="#cb60-4"></a>               <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb60-5"><a href="#cb60-5"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>,</span>
<span id="cb60-6"><a href="#cb60-6"></a>               <span class="at">values_to =</span> <span class="st">"pop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="#cb60-7"></a>  <span class="fu">fill</span>(., pop, <span class="at">.direction =</span> <span class="st">"down"</span>)</span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="fu">slice_tail</span>(popEU_long, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> year </th>
   <th style="text-align:right;"> pop </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgique </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:right;"> 80.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:right;"> 81.69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:right;"> 82.35 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<h3 id="combinaison-des-variables">Combinaison des variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Séparer une colonne en plusieurs colonnes</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">separate</span>(data, col, into)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="co"># Créer une seule colonne à partir de plusieurs colonnes</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="fu">unite</span>(col, ..., sep)</span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="co"># Générer toutes les combinaisons 2 à 2 possibles entre les variables définies</span></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="fu">expand</span>(data, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---separate">Applications - separate</h3>
<p>A partir du dernier popEU_long généré, transformer la colonne pop en caractères et créer deux nouvelles colonnes “millions” et “milliers”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>popEU_sep <span class="ot">&lt;-</span> popEU_long <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">mutate</span>(<span class="at">pop =</span> <span class="fu">as.character</span>(pop)) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>  <span class="fu">separate</span>(., <span class="at">col =</span> pop, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"millions"</span>, <span class="st">"milliers"</span>))</span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="fu">slice_head</span>(popEU_sep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> year </th>
   <th style="text-align:left;"> millions </th>
   <th style="text-align:left;"> milliers </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:left;"> 66 </td>
   <td style="text-align:left;"> 13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:left;"> 66 </td>
   <td style="text-align:left;"> 422 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:left;"> 66 </td>
   <td style="text-align:left;"> 602 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:left;"> 48 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:left;"> 44 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:left;"> 46 </td>
   <td style="text-align:left;"> 48 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---unite">Applications - unite</h3>
<p>Recréer la colonne pop comme à l’origine en la nommant population</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>popEU_unite <span class="ot">&lt;-</span> popEU_sep <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">unite</span>(., population, <span class="fu">c</span>(millions, milliers), <span class="at">sep =</span> <span class="st">"."</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="fu">slice_head</span>(popEU_unite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> year </th>
   <th style="text-align:left;"> population </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:left;"> 66.13 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:left;"> 66.422 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:left;"> 66.602 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2014 </td>
   <td style="text-align:left;"> 46.48 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2015 </td>
   <td style="text-align:left;"> 46.44 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Espagne </td>
   <td style="text-align:left;"> 2016 </td>
   <td style="text-align:left;"> 46.48 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="section-9" class="slide level2 smaller">
<h2></h2>
<h3 id="applications---expand">Applications - expand</h3>
<p>Générer un tableau avec toutes les combinaisons possibles pays/population. Que remarquons-nous ?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>popEU_expand <span class="ot">&lt;-</span> popEU_unite <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">expand</span>(., pays, population)</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="fu">slice_head</span>(popEU_expand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> pays </th>
   <th style="text-align:left;"> population </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 11.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 46.44 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 46.48 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 60.63 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 60.73 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Allemagne </td>
   <td style="text-align:left;"> 60.79 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><br></p>
<center>
<p>La valeur 11.21 n’apparait qu’une seule fois, ce sont bien les combinaisons uniques.</p>
<center>
</center></center></section>
<section id="exercice-3.1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.1</h2>
<ul>
<li>Chargez les données d’abondance. Les données sont elles tidy ?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb65-1" class="hljs-ln-code"><a href="#cb65-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.1-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.1 corrigé</h2>
<ul>
<li>Chargez les données d’abondance. Les données sont elles tidy ?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb66-1" class="hljs-ln-code"><a href="#cb66-1"></a><span class="co"># solution</span></span>
<span id="cb66-2" class="hljs-ln-code"><a href="#cb66-2"></a>abundance <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"./data/Global_reef_fish_abundance.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<center>
<p>Non les données ne sont pas tidy, car elles sont en format “wide”</p>
<center>
</center></center></section>
<section id="exercice-3.2" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.2</h2>
<ul>
<li>Transformez les en format tidy. Les nouvelles colonnes seront “sp_size” et “abundance”</li>
<li>Créez une nouvelle variable “survey_id_full” qui est l’union entre le survey_id et sp_size avec comme séparateur un “_”. Pensez à enchainer les opérations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb67-1" class="hljs-ln-code"><a href="#cb67-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.2-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.2 corrigé</h2>
<ul>
<li>Transformez les en format tidy. Les nouvelles colonnes seront “sp_size” et “abundance”</li>
<li>Créez une nouvelle variable “survey_id_full” qui est l’union entre le survey_id et sp_size avec comme séparateur un “_”. Pensez à enchainer les opérations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb68-1" class="hljs-ln-code"><a href="#cb68-1"></a><span class="co"># solution</span></span>
<span id="cb68-2" class="hljs-ln-code"><a href="#cb68-2"></a>abundance_long <span class="ot">&lt;-</span> abundance <span class="sc">%&gt;%</span></span>
<span id="cb68-3" class="hljs-ln-code"><a href="#cb68-3"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb68-4" class="hljs-ln-code"><a href="#cb68-4"></a>    .,</span>
<span id="cb68-5" class="hljs-ln-code"><a href="#cb68-5"></a>    <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">17523</span>,</span>
<span id="cb68-6" class="hljs-ln-code"><a href="#cb68-6"></a>    <span class="at">names_to =</span> <span class="st">"sp_size"</span>,</span>
<span id="cb68-7" class="hljs-ln-code"><a href="#cb68-7"></a>    <span class="at">values_to =</span> <span class="st">"abundance"</span>,</span>
<span id="cb68-8" class="hljs-ln-code"><a href="#cb68-8"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span> <span class="co"># Attention à l'argument values_dop_na</span></span>
<span id="cb68-9" class="hljs-ln-code"><a href="#cb68-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-10" class="hljs-ln-code"><a href="#cb68-10"></a>  <span class="fu">unite</span>(., <span class="at">col =</span> <span class="st">"survey_id_full"</span>, <span class="fu">c</span>(survey_id, sp_size), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb68-11" class="hljs-ln-code"><a href="#cb68-11"></a><span class="fu">slice_head</span>(abundance_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">

<table style="width:30%;">
 <thead>
  <tr>
   <th style="text-align:left;"> survey_id_full </th>
   <th style="text-align:right;"> abundance </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1003253_Cymatogaster.aggregata_5 </td>
   <td style="text-align:right;"> 250 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1003253_Embiotoca.lateralis_10 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1003253_Embiotoca.lateralis_12.5 </td>
   <td style="text-align:right;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1003253_Ophiodon.elongatus_35 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1003253_Ophiodon.elongatus_40 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1003253_Rhacochilus.vacca_10 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="exercice-3.3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.3</h2>
<ul>
<li>Créez un seul tableau regroupant biomasse et abondance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb69-1" class="hljs-ln-code"><a href="#cb69-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.3-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.3 corrigé</h2>
<ul>
<li>Créez un seul tableau regroupant biomasse et abondance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb70-1" class="hljs-ln-code"><a href="#cb70-1"></a><span class="co"># solution</span></span>
<span id="cb70-2" class="hljs-ln-code"><a href="#cb70-2"></a><span class="fu">load</span>(<span class="st">"./data/biomass_survey_exercice2_4.RData"</span>)</span>
<span id="cb70-3" class="hljs-ln-code"><a href="#cb70-3"></a>biomass_abundance <span class="ot">&lt;-</span> biomass_survey_exercice2_4 <span class="sc">%&gt;%</span></span>
<span id="cb70-4" class="hljs-ln-code"><a href="#cb70-4"></a>  <span class="fu">left_join</span>(., abundance_long, <span class="at">by =</span> <span class="st">"survey_id_full"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="exercice-3.4" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.4</h2>
<ul>
<li>Créez 2 nouvelles colonnes “genus” et “species” à partir de species_name</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb71-1" class="hljs-ln-code"><a href="#cb71-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.4-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.4 corrigé</h2>
<ul>
<li>Créez 2 nouvelles colonnes “genus” et “species” à partir de species_name</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb72-1" class="hljs-ln-code"><a href="#cb72-1"></a><span class="co"># solution</span></span>
<span id="cb72-2" class="hljs-ln-code"><a href="#cb72-2"></a>biomass_abundance <span class="ot">&lt;-</span> biomass_abundance <span class="sc">%&gt;%</span></span>
<span id="cb72-3" class="hljs-ln-code"><a href="#cb72-3"></a>  <span class="fu">separate</span>(., species_name, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"genus"</span>, <span class="st">"species"</span>))</span>
<span id="cb72-4" class="hljs-ln-code"><a href="#cb72-4"></a><span class="fu">slice_head</span>(biomass_abundance[,<span class="dv">8</span><span class="sc">:</span><span class="dv">11</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">

<table style="width:30%;">
 <thead>
  <tr>
   <th style="text-align:left;"> family </th>
   <th style="text-align:left;"> genus </th>
   <th style="text-align:left;"> species </th>
   <th style="text-align:right;"> biomass </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Labridae </td>
   <td style="text-align:left;"> Eupetrichthys </td>
   <td style="text-align:left;"> angustipes </td>
   <td style="text-align:right;"> 19.8984 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Plesiopidae </td>
   <td style="text-align:left;"> Trachinops </td>
   <td style="text-align:left;"> taeniatus </td>
   <td style="text-align:right;"> 76.6364 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentridae </td>
   <td style="text-align:left;"> Parma </td>
   <td style="text-align:left;"> microlepis </td>
   <td style="text-align:right;"> 169.2130 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Labridae </td>
   <td style="text-align:left;"> Labridae </td>
   <td style="text-align:left;"> spp </td>
   <td style="text-align:right;"> 19.8984 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Plesiopidae </td>
   <td style="text-align:left;"> Trachinops </td>
   <td style="text-align:left;"> taeniatus </td>
   <td style="text-align:right;"> 306.5455 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Pomacentridae </td>
   <td style="text-align:left;"> Chromis </td>
   <td style="text-align:left;"> hypsilepis </td>
   <td style="text-align:right;"> 6267.5000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="exercice-3.5" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.5</h2>
<ul>
<li>Transformez le tibble en sf object avec la commande sf::st_as_sf(survey, coords = c(“longitude”, “latitude”), remove = FALSE)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb73-1" class="hljs-ln-code"><a href="#cb73-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.5-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.5 corrigé</h2>
<ul>
<li>Transformez le tibble en sf object avec la commande sf::st_as_sf(survey, coords = c(“longitude”, “latitude”), remove = FALSE)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb74-1" class="hljs-ln-code"><a href="#cb74-1"></a><span class="co"># solution</span></span>
<span id="cb74-2" class="hljs-ln-code"><a href="#cb74-2"></a>data_sf <span class="ot">&lt;-</span></span>
<span id="cb74-3" class="hljs-ln-code"><a href="#cb74-3"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb74-4" class="hljs-ln-code"><a href="#cb74-4"></a>    biomass_abundance,</span>
<span id="cb74-5" class="hljs-ln-code"><a href="#cb74-5"></a>    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>) ,</span>
<span id="cb74-6" class="hljs-ln-code"><a href="#cb74-6"></a>    <span class="at">remove =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-7" class="hljs-ln-code"><a href="#cb74-7"></a>    <span class="at">crs =</span> <span class="st">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span></span>
<span id="cb74-8" class="hljs-ln-code"><a href="#cb74-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in st_as_sf.data.frame(biomass_abundance, coords = c("longitude", : missing values in coordinates not allowed</code></pre>
</div>
</div>
<br>
<center>
<p>Nous obtenons une erreur, car il n’est pas possible de convertir un tibble en objet sf s’il y a des valeurs manquantes dans les colonnes longitude et latitude</p>
<center>
</center></center></section>
<section id="exercice-3.6" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.6</h2>
<ul>
<li>Corrigez l’erreur</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb76-1" class="hljs-ln-code"><a href="#cb76-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-3.6-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 3.6 corrigé</h2>
<ul>
<li>Corrigez l’erreur</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb77-1" class="hljs-ln-code"><a href="#cb77-1"></a><span class="co"># solution</span></span>
<span id="cb77-2" class="hljs-ln-code"><a href="#cb77-2"></a>biomass_survey_abundance_exercice3_6 <span class="ot">&lt;-</span> biomass_abundance <span class="sc">%&gt;%</span></span>
<span id="cb77-3" class="hljs-ln-code"><a href="#cb77-3"></a>  <span class="fu">drop_na</span>(latitude) <span class="sc">%&gt;%</span> <span class="co">#supression des lignes contenant des NA dans la colonne latitude</span></span>
<span id="cb77-4" class="hljs-ln-code"><a href="#cb77-4"></a>  <span class="fu">drop_na</span>(longitude) <span class="sc">%&gt;%</span> <span class="co">#supression des lignes contenant des NA dans la colonne longitude</span></span>
<span id="cb77-5" class="hljs-ln-code"><a href="#cb77-5"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(</span>
<span id="cb77-6" class="hljs-ln-code"><a href="#cb77-6"></a>    .,</span>
<span id="cb77-7" class="hljs-ln-code"><a href="#cb77-7"></a>    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb77-8" class="hljs-ln-code"><a href="#cb77-8"></a>    <span class="at">remove =</span> <span class="cn">FALSE</span>,</span>
<span id="cb77-9" class="hljs-ln-code"><a href="#cb77-9"></a>    <span class="at">crs =</span> <span class="st">"+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"</span></span>
<span id="cb77-10" class="hljs-ln-code"><a href="#cb77-10"></a>  )</span>
<span id="cb77-11" class="hljs-ln-code"><a href="#cb77-11"></a><span class="fu">save</span>(biomass_survey_abundance_exercice3_6,</span>
<span id="cb77-12" class="hljs-ln-code"><a href="#cb77-12"></a>     <span class="at">file =</span> <span class="st">"./data/biomass_survey_abundance_exercice3_6.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section></section>
<section>
<section id="partie-4-extension-à-la-manipulation-de-données-cas-spécifiques" class="title-slide slide level1 center">
<h1>Partie 4 : Extension à la manipulation de données, cas spécifiques</h1>
<p><img data-src="images/logo_stringr.png" class="absolute" style="top: 300px; width: 20%; "> <img data-src="images/logo_lubridate.png" class="absolute" style="top: 300px; left: 300px; width: 20%; "></p>
</section>
<section id="manipuler-du-texte-avec-stringr" class="slide level2">
<h2>4.1 : Manipuler du texte avec stringr</h2>
<p>Conçu pour manipuler les chaines de caractères “facilement”. <br>En plus d’être plus faciles à utiliser, le nom des fonctions dans<br>
<code>stringr</code> représentent bien ce qu’elles permettent de faire.</p>
<p><img data-src="images/logo_stringr.png" class="absolute" style="top: 40px; right: 20px; width: 15%; "></p>
<div class="fragment">
<p>Le nom de toutes les fonctions dans <code>stringr</code> commence par <code>str_</code>.</p>
</div>
<div class="fragment">
<p>Voici quelques exemples :</p>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment"><p><code>str_detect</code> : Détection de caractères</p></li>
<li class="fragment"><p><code>str_extract</code> : Extraction de caractères</p></li>
<li class="fragment"><p><code>str_replace</code> : Remplacement de caractères</p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment"><p><code>str_trim</code> : Enlève les espaces</p></li>
<li class="fragment"><p><code>str_split</code> : Sépare une chaine de caractères</p></li>
<li class="fragment"><p><code>str_length</code> : Nombre de caractère</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="fragment">
<center>
Le cheat-sheet du package <code>stringr</code> est disponible <a href="https://github.com/rstudio/cheatsheets/blob/main/strings.pdf">ici</a>.
</center>
</div>
</section>
<section id="création-dun-dataframe-de-chaines-de-caractères" class="slide level2">
<h2>Création d’un dataframe de chaines de caractères</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">nom =</span> <span class="fu">c</span>(<span class="st">"Micheline Sétou"</span>, <span class="st">"Jean-Jacques Apeprès"</span>,  <span class="st">"Martine Sérien"</span>),</span>
<span id="cb78-2"><a href="#cb78-2"></a>              <span class="at">num_rue =</span> <span class="fu">c</span>(<span class="st">"12"</span>, <span class="st">"15 ou 16"</span>, <span class="st">"NA"</span>), </span>
<span id="cb78-3"><a href="#cb78-3"></a>              <span class="at">nom_rue =</span> <span class="fu">c</span>(<span class="st">"Rue des peupliers"</span>, <span class="st">"Rue + un arbre"</span>, <span class="st">"NA"</span>),</span>
<span id="cb78-4"><a href="#cb78-4"></a>              <span class="at">ville =</span> <span class="fu">c</span>(<span class="st">"Montpellier"</span>, <span class="st">"Montpellier"</span>, <span class="st">"Montpellier"</span>))</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="fu">kable</span>(tmp, <span class="at">html_font =</span> <span class="st">"Computer Modern"</span>, <span class="at">table.attr =</span> <span class="st">"style='width:60%;'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="width:60%;">
 <thead>
  <tr>
   <th style="text-align:left;"> nom </th>
   <th style="text-align:left;"> num_rue </th>
   <th style="text-align:left;"> nom_rue </th>
   <th style="text-align:left;"> ville </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Micheline Sétou </td>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:left;"> Rue des peupliers </td>
   <td style="text-align:left;"> Montpellier </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Jean-Jacques Apeprès </td>
   <td style="text-align:left;"> 15 ou 16 </td>
   <td style="text-align:left;"> Rue + un arbre </td>
   <td style="text-align:left;"> Montpellier </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Martine Sérien </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> NA </td>
   <td style="text-align:left;"> Montpellier </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="détection-de-caractères" class="slide level2">
<h2>Détection de caractères</h2>
<p>On utilise la fonction <code>str_detect()</code> et les deux arguments principaux :</p>
<div>
<ul>
<li class="fragment"><code>string</code> : Le/Les caractère(s) qui vont passer au détecteur.</li>
<li class="fragment"><code>pattern</code> : Le caractère à détecter.</li>
</ul>
</div>
<div class="fragment">
<p>La fonction renvoie <code>TRUE</code> ou <code>FALSE</code> en fonction de la présence ou non du caractère.</p>
</div>
<div class="fragment">
<h3 id="exemple">Exemple</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>tmp<span class="sc">$</span>nom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou
Jean-Jacques Apeprès
Martine Sérien</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">str_detect</span>(<span class="at">string  =</span> tmp<span class="sc">$</span>nom, <span class="at">pattern =</span> <span class="st">"ine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>TRUE
FALSE
TRUE</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<center>
<p>La fonction <code>str_detect()</code> peut donc être utilisée avec <code>filter()</code> pour faire une <br> sélection des lignes qui nous intéresse dans le tableau.</p>
</center></div>
</div>
</section>
<section id="sous-sélection-de-certains-caractères" class="slide level2">
<h2>Sous-sélection de certains caractères</h2>
<p>On utilise la fonction <code>str_subset()</code> et les deux arguments principaux :</p>
<div>
<ul>
<li class="fragment"><code>string</code> : Le/Les caractère(s) qui vont passer au détecteur.</li>
<li class="fragment"><code>pattern</code> : Le caractère à détecter.</li>
</ul>
</div>
<div class="fragment">
<p>Contrairement à <code>str_detect()</code>, la fonction <code>str_subset()</code> renvoie les caractères qui contiennent le pattern à détecter.</p>
</div>
<div class="fragment">
<h3 id="exemple-1">Exemple</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">str_subset</span>(<span class="at">string  =</span> tmp<span class="sc">$</span>nom, </span>
<span id="cb83-2"><a href="#cb83-2"></a>           <span class="at">pattern =</span> <span class="st">"ine"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Micheline Sétou" "Martine Sérien" </code></pre>
</div>
</div>
</div>
</section>
<section id="extraction-de-caractères" class="slide level2">
<h2>Extraction de caractères</h2>
<p>On utilise la fonction <code>str_extract()</code> et ses arguments principaux :</p>
<div>
<ul>
<li class="fragment"><code>string</code> : Le/Les caractère(s) qui vont passer à l’extracteur.</li>
<li class="fragment"><code>pattern</code> : Le caractère à extraire.</li>
</ul>
</div>
<div class="fragment">
<h3 id="exemple-2">Exemple</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>tmp<span class="sc">$</span>ville</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Montpellier
Montpellier
Montpellier</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">str_extract</span>(<span class="at">string  =</span> tmp<span class="sc">$</span>ville, </span>
<span id="cb87-2"><a href="#cb87-2"></a>            <span class="at">pattern =</span> <span class="st">"Montpel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Montpel
Montpel
Montpel</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="remplacer-un-caractère-par-un-autre" class="slide level2">
<h2>Remplacer un caractère par un autre</h2>
<p>On utilise la fonction <code>str_replace()</code> et ces arguments principaux :</p>
<div>
<ul>
<li class="fragment"><code>string</code> : Le/Les caractère(s) qui vont passer à l’extracteur.</li>
<li class="fragment"><code>pattern</code> : Le caractère à remplacer.</li>
<li class="fragment"><code>replacement</code> : Le caractère de remplacement.</li>
</ul>
</div>
<div class="fragment">
<h3 id="exemple-3">Exemple</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co"># Les noms avant le replacement</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>tmp<span class="sc">$</span>nom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou
Jean-Jacques Apeprès
Martine Sérien</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">str_replace</span>(<span class="at">string      =</span> tmp<span class="sc">$</span>nom, </span>
<span id="cb91-2"><a href="#cb91-2"></a>            <span class="at">pattern     =</span> <span class="st">"Jacques"</span>, </span>
<span id="cb91-3"><a href="#cb91-3"></a>            <span class="at">replacement =</span> <span class="st">"Michel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou
Jean-Michel Apeprès
Martine Sérien</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="concaténer-des-chaînes-de-caractères" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Concaténer des chaînes de caractères</h2>
<p>On utilise la fonction <code>str_glue()</code> et ces deux principaux arguments :</p>
<div>
<ul>
<li class="fragment">Le/les expressions à assembler entre <code>""</code>. Quand on veut ajouter l’information issue d’un data.frame, on met entre <code>{}</code>.</li>
<li class="fragment"><code>.sep</code> = le séparateur</li>
</ul>
</div>
<div class="fragment">
<h3 id="exemple-sur-une-ligne-du-data.frame">Exemple sur une ligne du data.frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb93-1" class="hljs-ln-code"><a href="#cb93-1"></a><span class="fu">str_glue</span>(<span class="st">"{tmp$nom[1]} habite au {tmp$num_rue[1]} {tmp$nom_rue[1]}"</span>, <span class="at">.sep =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou habite au 12 Rue des peupliers</code></pre>
</div>
</div>
</div>
</section>
<section id="concaténer-des-chaînes-de-caractères-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Concaténer des chaînes de caractères</h2>
<p>On utilise la fonction <code>str_glue()</code> et ces deux principaux arguments :</p>
<ul>
<li>Le/les expressions à assembler entre <code>""</code>. Quand on veut ajouter l’information issue d’un data.frame, on met entre <code>{}</code>.</li>
<li><code>.sep</code> = le séparateur</li>
</ul>
<h3 id="exemple-sur-une-ligne-du-data.frame-1">Exemple sur une ligne du data.frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">str_glue</span>(<span class="st">"{tmp$nom[1]} habite au {tmp$num_rue[1]} {tmp$nom_rue[1]}"</span>, <span class="at">.sep =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou habite au 12 Rue des peupliers</code></pre>
</div>
</div>
<h3 id="exemple-pour-tout-un-data.frame">Exemple pour tout un data.frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">str_glue_data</span>(tmp, <span class="st">"{nom}, habite au {num_rue} {nom_rue} dans la ville de {ville}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Micheline Sétou, habite au 12 Rue des peupliers dans la ville de Montpellier
Jean-Jacques Apeprès, habite au 15 ou 16 Rue + un arbre dans la ville de Montpellier
Martine Sérien, habite au NA NA dans la ville de Montpellier</code></pre>
</div>
</div>
</section>
<section id="exercice-4.1.1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 4.1.1</h2>
<p><strong>Question 1</strong> : Dans le fichier biomass_survey_abundance_exercice3_6.RData, filter les données qui mentionnent la Méditerranée dans la colonne location.</p>
<p><strong>Question 2</strong> : A partir du fichier global_reef_fish_biomass.csv chargé avec <code>read_delim()</code>, enchaîner le pipe pour obtenir un data.frame résumant le nombre d’observations dans chacune des classes, pour le site n°2000951 seulement.</p>
<p><strong>Question 3</strong> : Résolvez le problème de façon à obtenir un tibble de dimension 2x2.</p>
<p><strong>Question bonus</strong> : A partir de la colonne location, créer une colonne qui extrait l’orientation. La colonne orientation doit être homogène, donc pas d’espace, ni de parenthèses.</p>
</section>
<section id="exercice-4.1.1---correction-q1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 4.1.1 - Correction Q1</h2>
<p><strong>Question 1</strong> : Dans le fichier survey_metadata.csv, filter les données qui mentionnent la Méditerranée dans la colonne location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb99-1" class="hljs-ln-code"><a href="#cb99-1"></a><span class="fu">load</span>(<span class="st">"biomass_survey_abundance_exercice3_6.RData"</span>)</span>
<span id="cb99-2" class="hljs-ln-code"><a href="#cb99-2"></a>survey_med <span class="ot">&lt;-</span> biomass_survey_abundance_exercice3_6 <span class="sc">%&gt;%</span></span>
<span id="cb99-3" class="hljs-ln-code"><a href="#cb99-3"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(location, <span class="st">"Mediterranean"</span>) <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-4" class="hljs-ln-code"><a href="#cb99-4"></a><span class="fu">dim</span>(survey_med)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6411   37</code></pre>
</div>
</div>
</section>
<section id="exercice-4.1.1---correction-q2" class="slide level2">
<h2>Exercice 4.1.1 - Correction Q2</h2>
<p><strong>Question 2</strong> : A partir du fichier global_reef_fish_biomass.csv chargé avec <code>read_delim()</code>, enchaîner le pipe pour obtenir un data.frame résumant le nombre d’observations dans chacune des classes, pour le site n°2000951 seulement.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>global_reef_fish_biomass <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"./data/global_reef_fish_biomass.csv"</span>)</span>
<span id="cb101-2"><a href="#cb101-2"></a>global_reef_fish_biomass  <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="#cb101-3"></a>  <span class="fu">filter</span>(survey_id <span class="sc">==</span> <span class="st">"2000951"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="#cb101-4"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="#cb101-5"></a>  <span class="fu">summarise</span>(<span class="at">n_class =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<table style="width:50%;">
 <thead>
  <tr>
   <th style="text-align:left;"> class </th>
   <th style="text-align:right;"> n_class </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Actinopterygii </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Actinopterygii </td>
   <td style="text-align:right;"> 62 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elasmobranchii </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exercice-4.1.1---correction-q3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 4.1.1 - Correction Q3</h2>
<p><strong>Question 3</strong> : Résolvez le problème de façon à obtenir un tibble de dimension 2x2.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb102-1" class="hljs-ln-code"><a href="#cb102-1"></a>global_reef_fish_biomass <span class="sc">%&gt;%</span></span>
<span id="cb102-2" class="hljs-ln-code"><a href="#cb102-2"></a>  <span class="fu">filter</span>(survey_id <span class="sc">==</span> <span class="st">"2000951"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-3" class="hljs-ln-code"><a href="#cb102-3"></a>  <span class="fu">mutate</span>(<span class="at">class =</span> <span class="fu">str_trim</span>(class)) <span class="sc">%&gt;%</span></span>
<span id="cb102-4" class="hljs-ln-code"><a href="#cb102-4"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb102-5" class="hljs-ln-code"><a href="#cb102-5"></a>  <span class="fu">summarise</span>(<span class="at">n_class =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<table style="width:50%;">
 <thead>
  <tr>
   <th style="text-align:left;"> class </th>
   <th style="text-align:right;"> n_class </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Actinopterygii </td>
   <td style="text-align:right;"> 66 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elasmobranchii </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exercice-4.1.1---correction-q" class="slide level2">
<h2>Exercice 4.1.1 - Correction Q+</h2>
<p><strong>Question bonus</strong> : A partir de la colonne location, créer une colonne qui extrait l’orientation. La colonne orientation doit être homogène, donc pas d’espace, ni de parenthèses. Enregistrer le <strong>survey_med</strong> au format .RData</p>
<div class="fragment">
<p>Solution décomposée</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>survey_med <span class="ot">&lt;-</span> biomass_survey_abundance_exercice3_6 <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(location, <span class="st">"Mediterranean"</span>) <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="fu">mutate</span>(<span class="at">orientation =</span> <span class="fu">word</span>(location, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="fu">mutate</span>(<span class="at">orientation =</span> <span class="fu">str_replace</span>(orientation, <span class="st">" "</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="#cb103-5"></a>  <span class="fu">mutate</span>(<span class="at">orientation =</span> <span class="fu">str_replace</span>(orientation, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb103-6"><a href="#cb103-6"></a>  <span class="fu">mutate</span>(<span class="at">orientation =</span> <span class="fu">str_replace</span>(orientation, <span class="st">"</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">kable</span>(survey_med[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"orientation"</span>], <span class="at">html_font =</span> <span class="st">"Computer Modern"</span>, <span class="at">table.attr =</span> <span class="st">"style='width:50%;'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="width:50%;">
 <thead>
  <tr>
   <th style="text-align:left;"> orientation </th>
   <th style="text-align:left;"> geometry </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="exercice-4.1.1---correction-q-1" class="slide level2">
<h2>Exercice 4.1.1 - Correction Q+</h2>
<p><strong>Question bonus</strong> : A partir de la colonne location, créer une colonne qui extrait l’orientation. La colonne orientation doit être homogène, donc pas d’espace, ni de parenthèses. Enregistrer le <strong>survey_med</strong> au format .RData</p>
<div class="fragment">
<p>Solution plus courte</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>survey_med <span class="ot">&lt;-</span> biomass_survey_abundance_exercice3_6 <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(location, <span class="st">"Mediterranean"</span>) <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3"></a>  <span class="fu">mutate</span>(<span class="at">orientation =</span> <span class="fu">str_replace_all</span>(<span class="fu">word</span>(location, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb105-4"><a href="#cb105-4"></a>                                       <span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="st">""</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">("</span> <span class="ot">=</span> <span class="st">""</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">)"</span> <span class="ot">=</span> <span class="st">""</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">kable</span>(survey_med[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"orientation"</span>], <span class="at">html_font =</span> <span class="st">"Computer Modern"</span>, <span class="at">table.attr =</span> <span class="st">"style='width:50%;'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="width:50%;">
 <thead>
  <tr>
   <th style="text-align:left;"> orientation </th>
   <th style="text-align:left;"> geometry </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> northwest </td>
   <td style="text-align:left;"> POINT (3.16 42.43) </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="les-expressions-régulières" class="slide level2 smaller">
<h2>Les expressions régulières</h2>
<h3 id="outil-très-très-puissant">Outil très très puissant !</h3>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Il faut savoir que cela existe, mais demande un peu de patience et d’entrainement pour être utilisé</li>
<li>Regardez le <a href="https://github.com/rstudio/cheatsheets/blob/main/strings.pdf" target="_blank">deuxième volet</a> du cheatsheet de stringr</li>
<li>Permet de “selectionner” de manière “dynamique” des patterns dans vos données</li>
<li>Le plus difficile est de formuler de la meilleure façon ce que vous voulez
<ul>
<li>Il y a souvent plusieurs façons d’arriver à ce que vous voulez</li>
</ul></li>
<li>Parfois le plus simple est de reformuler ce que vous voulez faire, ou de le faire de manière séquentielle</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/regular_expressions.png"></p>
</div>
</div>
</section>
<section id="exemple-concret" class="slide level2">
<h2>Exemple concret</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./data/exemple_regular_expressions.RData"</span>)</span>
<span id="cb107-2"><a href="#cb107-2"></a>tac_final_modif_level1 <span class="ot">&lt;-</span> tac_final <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3"></a>  <span class="fu">mutate</span>(<span class="at">adapted_quota =</span> <span class="fu">as.numeric</span>(<span class="at">x =</span> adapted_quota_ori)) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4"></a>  <span class="fu">relocate</span>(adapted_quota,</span>
<span id="cb107-5"><a href="#cb107-5"></a>           <span class="at">.after =</span> adapted_quota_ori)</span>
<span id="cb107-6"><a href="#cb107-6"></a>tac_final_modif_level1_check <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">.data =</span> tac_final_modif_level1,</span>
<span id="cb107-7"><a href="#cb107-7"></a>                                       <span class="fu">is.na</span>(<span class="at">x =</span> adapted_quota)) <span class="sc">%&gt;%</span></span>
<span id="cb107-8"><a href="#cb107-8"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(adapted_quota_ori,</span>
<span id="cb107-9"><a href="#cb107-9"></a>                adapted_quota)</span>
<span id="cb107-10"><a href="#cb107-10"></a>tac_final_modif_level2 <span class="ot">&lt;-</span> tac_final <span class="sc">%&gt;%</span></span>
<span id="cb107-11"><a href="#cb107-11"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-12"><a href="#cb107-12"></a>  <span class="fu">mutate</span>(<span class="at">adapted_quota =</span> <span class="fu">case_when</span>(</span>
<span id="cb107-13"><a href="#cb107-13"></a>    <span class="fu">str_detect</span>(<span class="at">string =</span> adapted_quota_ori,</span>
<span id="cb107-14"><a href="#cb107-14"></a>               <span class="at">pattern =</span> <span class="st">"^[:digit:]+[:punct:][:digit:]+$"</span>) <span class="sc">~</span> <span class="fu">str_replace</span>(<span class="at">string =</span> adapted_quota_ori,</span>
<span id="cb107-15"><a href="#cb107-15"></a>                                                                          <span class="at">pattern =</span> <span class="st">"[:punct:]"</span>, </span>
<span id="cb107-16"><a href="#cb107-16"></a>                                                                          <span class="at">replacement =</span> <span class="st">"."</span>),</span>
<span id="cb107-17"><a href="#cb107-17"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> adapted_quota_ori)) <span class="sc">%&gt;%</span></span>
<span id="cb107-18"><a href="#cb107-18"></a>  <span class="fu">relocate</span>(adapted_quota,</span>
<span id="cb107-19"><a href="#cb107-19"></a>           <span class="at">.after =</span> adapted_quota_ori) <span class="sc">%&gt;%</span></span>
<span id="cb107-20"><a href="#cb107-20"></a>  <span class="fu">mutate</span>(<span class="at">adapted_quota =</span> <span class="fu">as.numeric</span>(<span class="at">x =</span> adapted_quota))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="manipuler-des-dates-avec-lubridate" class="title-slide slide level1 center">
<h1>4.2 : Manipuler des dates avec lubridate</h1>

</section>
<section id="rend-la-manipulation-des-dates-et-du-temps-presque-agréable-sous-r" class="slide level2">
<h2>Rend la manipulation des dates et du temps presque agréable sous R</h2>
<ul>
<li><p>Analyse semi-automatique des dates et des heures</p></li>
<li><p>Les fonctions vont essayer de trouver le séparateur et le format</p></li>
<li><p>Possibilité de rajouter l’indicateur de fuseau horaire via l’argument tz</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="co"># Identifie l'ordre de l'année (y), le mois (m), le jour (d), l'heure (h), la minute (m) et la second (s) d'un élement fournis à R</span></span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="fu">ymd</span>()</span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="fu">mdy</span>()</span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="fu">dmy</span>()</span>
<span id="cb108-6"><a href="#cb108-6"></a><span class="fu">ymd_hms</span>()</span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="co"># Beaucoup de possibilités, jeter un coup d'oeil sur le cheatsheet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="manipulation-des-élements-date-temps" class="slide level2">
<h2>Manipulation des élements date-temps</h2>
<h3 id="modification-et-extraction">Modification et extraction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>test_date_time <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2022-12-05 12:00:00"</span>, <span class="at">tz =</span> <span class="st">"CET"</span>)</span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="co"># pour une extraction des informations</span></span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="fu">second</span>()</span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="fu">hour</span>()</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="fu">day</span>()</span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="fu">wday</span>()</span>
<span id="cb109-7"><a href="#cb109-7"></a><span class="fu">month</span>()</span>
<span id="cb109-8"><a href="#cb109-8"></a>...</span>
<span id="cb109-9"><a href="#cb109-9"></a><span class="co"># pour modifier les informations, utiliser les fonctions précédentes avec une assignation (&lt;-)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tour-dhorizon" class="slide level2">
<h2>Tour d’horizon</h2>
<ul>
<li><p>Les fuseaux horaires, un cauchemar par le passé, maintenant ça va mieux</p></li>
<li><p>Deux fonctions clés</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co"># Pour exprimer un élément dans un autre fuseau horaire</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="fu">with_tz</span>()</span>
<span id="cb110-3"><a href="#cb110-3"></a><span class="co"># Pour forcer le changement d'un fuseau horaire mais en conservant la même heure</span></span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="fu">force_tz</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<ul>
<li><p>3 classes pour calculer des intervalles de temps</p></li>
<li><p>Periode, durée et intervalle</p></li>
<li><p>Le plus “dur” est de définir votre date-temps, après c’est une syntaxe mathématique</p></li>
</ul>
</section>
<section id="bonus" class="slide level2">
<h2>Bonus</h2>
<ul>
<li><p>Les fonctions sont vectorisables !</p></li>
<li><p>Sur certains jeux de données, les dates-temps sont stockées en nombre de secondes depuis 1970-01-01 00:00:00 UTC. Utiliser cette fonction dans ce cas-là :</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="fu">as_datetime</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Possibilité de faire des arrondis</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># arrondi inférieur sur "l'unité" la plus proche</span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="fu">floor_date</span>()</span>
<span id="cb112-3"><a href="#cb112-3"></a><span class="co"># arrondi inférieur sur "l'unité" la plus proche</span></span>
<span id="cb112-4"><a href="#cb112-4"></a><span class="fu">round_date</span>()</span>
<span id="cb112-5"><a href="#cb112-5"></a><span class="co"># arrondie supérieur sur "l'unité" la plus proche</span></span>
<span id="cb112-6"><a href="#cb112-6"></a><span class="fu">ceiling_date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="partie-5-visualisation-des-données-avec-ggplot2" class="title-slide slide level1 center">
<h1>Partie 5 : Visualisation des données avec <code>ggplot2</code></h1>

<img data-src="images/ggplot2_logo.png" class="r-stretch"></section>
<section id="petit-aperçu-des-possibilités" class="slide level2">
<h2>Petit aperçu des possibilités :</h2>
<center>
<p><a href="https://r-graph-gallery.com/" data-preview-link="true">Le site <strong>From Data To Viz</strong>, une pépite</a></p>
<p><img data-src="images/R_graph_gallery.PNG" class="absolute" style="top: 150px; left: 200px; width: 65%; "></p>
</center></section>
<section id="ggplot-cest-comme-la-chirurgie-aesthétique" class="slide level2">
<h2>Ggplot c’est comme la chirurgie <em><code>aes</code></em>thétique :</h2>
<div>
<div class="columns">
<ol type="1">
<li class="fragment"><p>Les jeunes s’y mettent très tôt !</p></li>
<li class="fragment"><p>Les moins jeunes sont réticents puis CERTAINS finissent par s’y mettre<br>
<img data-src="images/nancy_pelosi.jpg" class="absolute" style="top: 260px; left: 370px; width: 22%; "></p></li>
</ol><p><br><br><br></p><ol start="3" type="1">
<li class="fragment">C’est un enchainement plus ou moins long d’opérations. <img data-src="images/bogdanoff1.jpg" class="absolute" style="top: 521px; left: 50px; width: 22%; "><br>
<img data-src="images/bogdanoff1.5.jpg" class="absolute" style="top: 500px; left: 360px; width: 25%; "> <img data-src="images/bogdanoff2.jpg" class="absolute" style="top: 500px; left: 700px; width: 25%; "></li>
</ol>
</div>
</div>
</section>
<section id="ggplot-une-succession-de-couches" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ggplot, une succession de couches</h2>
<div>
<div class="columns">
<div class="column">
<ol type="1">
<li class="fragment"><p>La Structure</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-123-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div><div class="column">
<ol start="2" type="1">
<li class="fragment"><p>Le Type de représentation</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-124-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div>
</div>
<div class="columns">
<div class="column">
<ol start="3" type="1">
<li class="fragment"><p>Les Couleurs</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-125-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div><div class="column">
<ol start="4" type="1">
<li class="fragment"><p>Le Lifting final</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-126-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div>
</div>
</div>
</section>
<section id="ggplot-une-succession-de-couches-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ggplot, une succession de couches</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li><p>La Structure</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-127-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div><div class="column">
<ol start="2" type="1">
<li><p>Le Type de représentation</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-128-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div>
</div>
<div class="columns">
<div class="column">
<ol start="3" type="1">
<li><p>Les Couleurs</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-129-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div><div class="column">
<ol start="4" type="1">
<li><p>Le Lifting final</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-130-1.png" style="width:75.0%"></p>
</div>
</div></li>
</ol>
</div>
</div>
</section>
<section id="la-structure-des-données" class="slide level2">
<h2>La structure des données</h2>
<p>Pour la démonstration nous allons utiliser le jeu de données <code>crabs</code> de la librairie <code>MASS</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb113-2"><a href="#cb113-2"></a>data_crabs <span class="ot">&lt;-</span> crabs <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(sp, sex, CL, CW)</span>
<span id="cb113-3"><a href="#cb113-3"></a>data_crabs <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4"></a>  <span class="fu">head</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">"Crabs data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="#cb113-6"></a>  <span class="fu">kable_classic</span>(<span class="at">html_font =</span> <span class="st">"Computer Modern"</span>, <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Computer Modern; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Crabs data</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> sp </th>
   <th style="text-align:left;"> sex </th>
   <th style="text-align:right;"> CL </th>
   <th style="text-align:right;"> CW </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 19.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 20.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 22.4 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-la-structure" class="slide level2">
<h2>Ggplot pas à pas : La Structure</h2>
<div>
<div>
<p>Pour la structure de la figure, la fonction à toujours utiliser est <code>ggplot()</code> . Les arguments principaux sont :</p>
<div>
<ul>
<li class="fragment"><p><code>data = nom.du.dataframe</code></p></li>
<li class="fragment"><p><code>mapping = aes(x = variable.x, y = variable.y)</code></p>
<div>
<ul>
<li class="fragment"><p>Ici le <code>aes</code> signifie <strong>aesthetic</strong></p></li>
<li class="fragment"><p>On verra que d’autres options sont disponibles dans <code>aes</code> comme la taille (<code>size</code>), la couleur (<code>color</code>), la forme (<code>shape</code>) …</p></li>
</ul>
</div></li>
</ul>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-la-structure-1" class="slide level2">
<h2>Ggplot pas à pas : La Structure</h2>
<div>
<div>
<p>Pour la structure de la figure, la fonction à toujours utiliser est <code>ggplot()</code> . Les arguments principaux sont :</p>
<div>
<ul>
<li><p><code>data = nom.du.dataframe</code></p></li>
<li><p><code>mapping = aes(x = variable.x, y = variable.y)</code></p></li>
</ul>
</div>
</div>
</div>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>couche<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data    =</span> data_crabs,</span>
<span id="cb114-2"><a href="#cb114-2"></a>                   <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CL, <span class="at">y =</span> CW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-134-1.png" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-choix-du-plot" class="slide level2">
<h2>Ggplot pas à pas : Choix du plot</h2>
<div>
<div>
<p>Plusieurs représentations existent selon le type de variables que l’on a :</p>
</div>
<div class="columns">
<div class="column">
<ol type="1">
<li class="fragment"><p><strong>Une variable continue</strong></p>
<div>
<ul>
<li class="fragment"><p><code>geom_histogram()</code></p></li>
<li class="fragment"><p><code>geom_density()</code></p></li>
</ul>
</div></li>
</ol>
</div><div class="column">
<ol start="2" type="1">
<li class="fragment"><p><strong>Deux variables continues</strong></p>
<div>
<ul>
<li class="fragment"><code>geom_point()</code></li>
<li class="fragment"><code>geom_line()</code></li>
<li class="fragment"><code>geom_area()</code></li>
</ul>
</div></li>
</ol>
</div>
</div>
</div>
<div>
<div class="columns">
<div class="column">
<ol start="3" type="1">
<li class="fragment"><p><strong>Une discrète &amp; une continue</strong></p>
<div>
<ul>
<li class="fragment"><code>geom_boxplot()</code></li>
<li class="fragment"><code>geom_violin()</code></li>
<li class="fragment"><code>geom_col()</code></li>
</ul>
</div></li>
</ol>
</div><div class="column">
<ol start="4" type="1">
<li class="fragment"><p><strong>Données spatiales</strong></p>
<div>
<ul>
<li class="fragment"><p><code>geom_polygon()</code></p></li>
<li class="fragment"><p><code>geom_sf()</code></p></li>
</ul>
</div></li>
</ol>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-choix-du-plot-1" class="slide level2">
<h2>Ggplot pas à pas : Choix du plot</h2>
<div>
<p>L’exemple ici va mener à la réalisation d’un <strong>nuage de points</strong>. Mais <code>ggplot2</code> fonctionne de la même façon pour construire un <strong>diagramme en barres</strong>, <strong>une boite à moustache</strong> ou autres.</p>
<div>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><p><code>aes()</code> dans <code>ggplot()</code></p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>couche<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data    =</span> data_crabs,</span>
<span id="cb115-2"><a href="#cb115-2"></a>                   <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CL, </span>
<span id="cb115-3"><a href="#cb115-3"></a>                                 <span class="at">y =</span> CW)) <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p><code>aes()</code> dans <code>geom_point()</code></p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># Autre solution</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>couche.<span class="fl">2.2</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb116-3"><a href="#cb116-3"></a>  <span class="fu">geom_point</span>(<span class="at">data    =</span> data_crabs,</span>
<span id="cb116-4"><a href="#cb116-4"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> CL, <span class="at">y =</span> CW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-137-1.png" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-modèle-linéaire" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ggplot pas à pas : Modèle linéaire</h2>
<p>Traçons un modèle linéaire et ajoutons la formule et le R² correspondant</p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb117-1" class="hljs-ln-code"><a href="#cb117-1"></a>couche<span class="fl">.3</span> <span class="ot">&lt;-</span> couche<span class="fl">.2</span> <span class="sc">+</span></span>
<span id="cb117-2" class="hljs-ln-code"><a href="#cb117-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"lm"</span>) <span class="co"># le modèle linéaire </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-139-1.png" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-modèle-linéaire-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ggplot pas à pas : Modèle linéaire</h2>
<p>Traçons un modéle linéaire et ajoutons la formule et le R² correspondant</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb118-1" class="hljs-ln-code"><a href="#cb118-1"></a>couche<span class="fl">.3</span> <span class="ot">&lt;-</span> couche<span class="fl">.2</span> <span class="sc">+</span></span>
<span id="cb118-2" class="hljs-ln-code"><a href="#cb118-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="co"># le modèle linéaire </span></span>
<span id="cb118-3" class="hljs-ln-code"><a href="#cb118-3"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.y =</span> <span class="dv">52</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..eq.label..)) <span class="co"># la formule</span></span>
<span id="cb118-4" class="hljs-ln-code"><a href="#cb118-4"></a>couche<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-140-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="ggplot-pas-à-pas-modèle-linéaire-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ggplot pas à pas : Modèle linéaire</h2>
<p>Traçons un modèle linéaire et ajoutons la formule et le R² correspondant</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb119-1" class="hljs-ln-code"><a href="#cb119-1"></a>couche<span class="fl">.3</span> <span class="ot">&lt;-</span> couche<span class="fl">.2</span> <span class="sc">+</span></span>
<span id="cb119-2" class="hljs-ln-code"><a href="#cb119-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="co"># le modèle linéaire </span></span>
<span id="cb119-3" class="hljs-ln-code"><a href="#cb119-3"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.y =</span> <span class="dv">52</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..eq.label..)) <span class="sc">+</span> <span class="co"># la formule</span></span>
<span id="cb119-4" class="hljs-ln-code"><a href="#cb119-4"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.y =</span> <span class="dv">48</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..adj.rr.label..)) <span class="co"># R²</span></span>
<span id="cb119-5" class="hljs-ln-code"><a href="#cb119-5"></a>couche<span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-141-1.png" style="width:50.0%" class="r-stretch quarto-figure-center"></section>
<section id="ggplot-pas-à-pas-la-couleur" class="slide level2">
<h2>Ggplot pas à pas : La couleur</h2>
<p>Donnons une couleur par sexe. Comme c’est lié à l’esthétisme de la figure, il faut retourner à l’argument <code>color</code> dans la fonction <code>aes()</code>.</p>
<div class="fragment">
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>couche<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">geom_point</span>(<span class="at">data    =</span> data_crabs,</span>
<span id="cb120-3"><a href="#cb120-3"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x     =</span> CL, </span>
<span id="cb120-4"><a href="#cb120-4"></a>                           <span class="at">y     =</span> CW, </span>
<span id="cb120-5"><a href="#cb120-5"></a>                           <span class="at">color =</span> sex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-143-1.png" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-couleurs-légende" class="slide level2 smaller">
<h2>Ggplot pas à pas : Couleurs &amp; légende</h2>
<p>Pour cela, on peut utiliser la fonction <code>scale_color_manual()</code> et les arguments <code>name</code> et <code>values</code>.</p>
<div class="fragment">
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>couche<span class="fl">.5</span> <span class="ot">&lt;-</span> couche<span class="fl">.4</span> <span class="sc">+</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name   =</span> <span class="st">"Sex :"</span>,</span>
<span id="cb121-3"><a href="#cb121-3"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>, </span>
<span id="cb121-4"><a href="#cb121-4"></a>                                <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-145-1.png" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<center>
Une autre façon de faire est d’utiliser la fonction <code>labs</code> qui permet de changer les diverses légendes (axes x et y + légende de couleur)
</center>
</div>
</section>
<section id="ggplot-pas-à-pas-légende-v.2" class="slide level2">
<h2>Ggplot pas à pas : Légende v.2</h2>
<div class="cell" data-layout-align="center" data-warnings="false">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>couche<span class="fl">.6</span> <span class="ot">&lt;-</span> couche<span class="fl">.5</span> <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>  <span class="fu">labs</span>(<span class="at">x     =</span> <span class="st">"Carapace Length (mm)"</span>,</span>
<span id="cb122-3"><a href="#cb122-3"></a>       <span class="at">y     =</span> <span class="st">"Carapace Width (mm)"</span>,</span>
<span id="cb122-4"><a href="#cb122-4"></a>       <span class="at">color =</span> <span class="st">"Sex :"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-147-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-le-facet" class="slide level2">
<h2>Ggplot pas à pas : le FACET</h2>
<p>La fonction <code>facet_grid()</code> permet de générer X plots pour chaque valeur d’une variable qualitative (i.e.&nbsp;l’espèce).</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>couche<span class="fl">.7</span> <span class="ot">&lt;-</span> couche<span class="fl">.6</span> <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-149-1.png" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="ggplot-pas-à-pas-larrière-plan" class="slide level2">
<h2>Ggplot pas à pas : l’arrière plan</h2>
<p><br> On utilise une des fonctions <code>theme_*</code>.</p>
<div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>couche<span class="fl">.7</span> <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb124-2"><a href="#cb124-2"></a>couche<span class="fl">.7</span> <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb124-3"><a href="#cb124-3"></a>couche<span class="fl">.7</span> <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-warnings="false">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-150-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-150-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-150-3.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<center>
Un tas de <code>theme_*</code> existent pour obtenir différentes formats d’arrière plan (voir <a href="http://www.sthda.com/english/wiki/ggplot2-themes-and-background-colors-the-3-elements">ici</a>). A vous de choisir votre préféré.
</center>
</div>
</section>
<section id="ggplot-pas-à-pas-le-lifting-final" class="slide level2">
<h2>Ggplot pas à pas : le lifting final</h2>
<p>La fonction <code>theme()</code> permet de lifter BEAUCOUP de choses (<code>?theme</code>). <br> Elle doit toujours apparaître en dernier de façon à ne pas être écrasée par une autre couche.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>couche<span class="fl">.8</span> <span class="ot">&lt;-</span> couche<span class="fl">.7</span> <span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb125-3"><a href="#cb125-3"></a>  <span class="fu">theme</span>(<span class="at">axis.text       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb125-4"><a href="#cb125-4"></a>        <span class="at">axis.title      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb125-5"><a href="#cb125-5"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb125-6"><a href="#cb125-6"></a>        <span class="at">legend.text     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb125-7"><a href="#cb125-7"></a>        <span class="at">legend.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-152-1.png" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="enregistrer-ses-figures" class="slide level2">
<h2>Enregistrer ses figures</h2>
<p>Pour enregistrer votre ggplot, vous pouvez utiliser la fonction <code>ggsave()</code> :</p>
<div>
<ul>
<li class="fragment"><code>plot</code> : le nom du ggplot à enregistrer.</li>
<li class="fragment"><code>filename</code> : le_chemin_daccess/le_nom_denregistrement.EXTENSION</li>
<li class="fragment"><code>width</code> &amp; <code>height</code> : la largeur et hauteur d’enregistrement.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"le_chemin_vers_le_bon_dossier"</span>, </span>
<span id="cb126-2"><a href="#cb126-2"></a>       <span class="at">plot     =</span> boxplot_biomass_country_v3,</span>
<span id="cb126-3"><a href="#cb126-3"></a>       <span class="at">width    =</span> <span class="dv">8</span>,</span>
<span id="cb126-4"><a href="#cb126-4"></a>       <span class="at">height   =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercice-5.1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.1</h2>
<p>Quel est le pays dans lequel la biomasse totale par transect est la plus forte ? Formatter le jeu de données issues de l’<strong>exercice 3.6</strong> et représenter visuellement les données sous forme de boites à moustache, <strong>seulement pour les données prélevées en 2011</strong>. Nommer le jeu de données <strong>data_biomass_country</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb127-1" class="hljs-ln-code"><a href="#cb127-1"></a><span class="co"># 1 - Filter les données obtenues en 2011</span></span>
<span id="cb127-2" class="hljs-ln-code"><a href="#cb127-2"></a><span class="co"># 2 - Grouper les données pour obtenir la biomasse totale</span></span>
<span id="cb127-3" class="hljs-ln-code"><a href="#cb127-3"></a><span class="co">#     par transect dans chacun des pays</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.1-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.1 : Correction</h2>
<p>Quel est le pays dans lequel la biomasse totale par transect est la plus forte ? Formatter le jeu de données issues de l’<strong>exercice 3.6</strong> et représenter visuellement les données sous forme de boites à moustache, <strong>seulement pour les données prélevées en 2011</strong>. Nommer le jeu de données <strong>data_biomass_country</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb128-1" class="hljs-ln-code"><a href="#cb128-1"></a>data_biomass_country <span class="ot">&lt;-</span> biomass_survey_abundance_exercice3_6 <span class="sc">%&gt;%</span></span>
<span id="cb128-2" class="hljs-ln-code"><a href="#cb128-2"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-3" class="hljs-ln-code"><a href="#cb128-3"></a>  <span class="co"># 1 - Filter les données obtenues en 2011</span></span>
<span id="cb128-4" class="hljs-ln-code"><a href="#cb128-4"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="at">string =</span> survey_date, <span class="at">pattern =</span> <span class="st">"2011"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb128-5" class="hljs-ln-code"><a href="#cb128-5"></a>  <span class="co"># 2 - Grouper les données pour obtenir la biomasse totale</span></span>
<span id="cb128-6" class="hljs-ln-code"><a href="#cb128-6"></a>  <span class="co">#     par transect dans chacun des pays</span></span>
<span id="cb128-7" class="hljs-ln-code"><a href="#cb128-7"></a>  <span class="fu">group_by</span>(country, survey_id) <span class="sc">%&gt;%</span></span>
<span id="cb128-8" class="hljs-ln-code"><a href="#cb128-8"></a>  <span class="fu">summarise</span>(<span class="at">biomass =</span> <span class="fu">sum</span>(biomass)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.1-correction-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.1 : Correction</h2>
<p>Quel est le pays dans lequel la biomasse totale par transect est la plus forte ? Formatter le jeu de données issues de l’<strong>exercice 3.6</strong> et représenter visuellement les données sous forme de boites à moustache, <strong>seulement pour les données prélevées en 2011</strong>. Nommer le jeu de données <strong>data_biomass_country</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb129-1" class="hljs-ln-code"><a href="#cb129-1"></a><span class="co"># Réalisation les boites à moustache</span></span>
<span id="cb129-2" class="hljs-ln-code"><a href="#cb129-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_biomass_country) <span class="sc">+</span></span>
<span id="cb129-3" class="hljs-ln-code"><a href="#cb129-3"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> biomass)) <span class="sc">+</span></span>
<span id="cb129-4" class="hljs-ln-code"><a href="#cb129-4"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-156-1.png" width="50" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.2</h2>
<p>Ce ggplot n’est cependant pas entièrement satisfaisant … <br> Nous avons du mal à savoir visuellement quelle est la 2nd ou la 3ème nation avec le plus de biomasse.</p>
<div class="fragment">
<p>Une solution est d’utiliser la fonction <code>reorder()</code> pour ordonner l’axe des x.</p>
<p>Utiliser cette fonction pour ordonner l’axe des x de façon décroissante selon la valeur <strong>médiane</strong>. Nommer le plot <strong>boxplot_biomass_country</strong>. <br> N’hésitez pas à regarder l’aide <code>?reorder</code> ou à chercher sur internet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb130-1" class="hljs-ln-code"><a href="#cb130-1"></a><span class="co"># Utilisation de reorder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercice-5.2-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.2 : Correction</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb131-1" class="hljs-ln-code"><a href="#cb131-1"></a><span class="co"># Reorder en fonction de la valeur médiane </span></span>
<span id="cb131-2" class="hljs-ln-code"><a href="#cb131-2"></a>boxplot_biomass_country <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_biomass_country) <span class="sc">+</span></span>
<span id="cb131-3" class="hljs-ln-code"><a href="#cb131-3"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, <span class="sc">-</span>biomass, <span class="at">FUN =</span> median), <span class="at">y =</span> biomass)) <span class="sc">+</span></span>
<span id="cb131-4" class="hljs-ln-code"><a href="#cb131-4"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb131-5" class="hljs-ln-code"><a href="#cb131-5"></a>boxplot_biomass_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-158-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.3</h2>
<p>Renommer proprement les axes de boxplot_biomass_country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb132-1" class="hljs-ln-code"><a href="#cb132-1"></a><span class="co"># Solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.3-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.3 : Correction</h2>
<p>Renommer proprement les axes de boxplot_biomass_country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb133-1" class="hljs-ln-code"><a href="#cb133-1"></a><span class="co"># Solution</span></span>
<span id="cb133-2" class="hljs-ln-code"><a href="#cb133-2"></a>boxplot_biomass_country_v2 <span class="ot">&lt;-</span> boxplot_biomass_country <span class="sc">+</span></span>
<span id="cb133-3" class="hljs-ln-code"><a href="#cb133-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb133-4" class="hljs-ln-code"><a href="#cb133-4"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-161-1.png" style="width:70.0%" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.4</h2>
<p>Dans la fonction <code>element_text()</code>, un argument permet de tourner les légendes des axes pour que les pays soient plus lisibles. Trouver cet argument et appliquer une rotation de 45° à la légende de l’axe x. Choisir votre arrière plan préféré.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb134-1" class="hljs-ln-code"><a href="#cb134-1"></a><span class="co"># Solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.4-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.4 : Correction</h2>
<p>Dans la fonction <code>element_text()</code>, un argument permet de tourner les légendes des axes pour que les pays soient plus lisibles. Trouver cet argument et appliquer une rotation de 45° à la légende de l’axe x. Choisir votre arrière plan préféré.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb135-1" class="hljs-ln-code"><a href="#cb135-1"></a><span class="co"># Solution</span></span>
<span id="cb135-2" class="hljs-ln-code"><a href="#cb135-2"></a>boxplot_biomass_country_v3 <span class="ot">&lt;-</span> boxplot_biomass_country_v2 <span class="sc">+</span></span>
<span id="cb135-3" class="hljs-ln-code"><a href="#cb135-3"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-4" class="hljs-ln-code"><a href="#cb135-4"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-164-1.png" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-5.5" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.5</h2>
<p>Enregistrer la figure <strong>boxplot_biomass_country_v3</strong> au format <strong>.png</strong>, avec une largeur et hauteur appropriées pour lire correctement le plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb136-1" class="hljs-ln-code"><a href="#cb136-1"></a><span class="co"># Solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.5-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.5 : Correction</h2>
<p>Enregistrer la figure <strong>boxplot_biomass_country_v3</strong> au format <strong>.png</strong>, avec une largeur et hauteur appropriées pour lire correctement le plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb137-1" class="hljs-ln-code"><a href="#cb137-1"></a><span class="co"># Solution</span></span>
<span id="cb137-2" class="hljs-ln-code"><a href="#cb137-2"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figures/boxplot_biomass_vs_country.png"</span>, </span>
<span id="cb137-3" class="hljs-ln-code"><a href="#cb137-3"></a>       <span class="at">plot     =</span> boxplot_biomass_country_v3,</span>
<span id="cb137-4" class="hljs-ln-code"><a href="#cb137-4"></a>       <span class="at">width    =</span> <span class="dv">8</span>,</span>
<span id="cb137-5" class="hljs-ln-code"><a href="#cb137-5"></a>       <span class="at">height   =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="une-petite-subtilité-concernant-les-couleurs" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Une petite subtilité concernant les couleurs</h2>
<p><strong>fill</strong> vs.&nbsp;<strong>color</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb138-1" class="hljs-ln-code"><a href="#cb138-1"></a><span class="co"># Solution questions 1 &amp; 2</span></span>
<span id="cb138-2" class="hljs-ln-code"><a href="#cb138-2"></a>data_biomass_5country <span class="ot">&lt;-</span> data_biomass_country <span class="sc">%&gt;%</span></span>
<span id="cb138-3" class="hljs-ln-code"><a href="#cb138-3"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Spain"</span>, <span class="st">"United States"</span>, <span class="st">"Italy"</span>, <span class="st">"Costa Rica"</span>, <span class="st">"Panama"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-4" class="hljs-ln-code"><a href="#cb138-4"></a>  <span class="fu">mutate</span>(<span class="at">Continent =</span> <span class="fu">case_when</span>((country <span class="sc">==</span> <span class="st">"Spain"</span><span class="sc">|</span> country <span class="sc">==</span> <span class="st">"Italy"</span>) <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb138-5" class="hljs-ln-code"><a href="#cb138-5"></a>                                country <span class="sc">==</span> <span class="st">"United States"</span> <span class="sc">~</span> <span class="st">"North America"</span>,</span>
<span id="cb138-6" class="hljs-ln-code"><a href="#cb138-6"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"South America"</span>))</span>
<span id="cb138-7" class="hljs-ln-code"><a href="#cb138-7"></a><span class="co"># Solution pour le plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="une-petite-subtilité-concernant-les-couleurs-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Une petite subtilité concernant les couleurs</h2>
<p>Reconstruction d’un boxplot en <strong>remplissant</strong> chaque boite d’une couleur pour chaque continent.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb139-1" class="hljs-ln-code"><a href="#cb139-1"></a><span class="co"># Solution pour le plot</span></span>
<span id="cb139-2" class="hljs-ln-code"><a href="#cb139-2"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb139-3" class="hljs-ln-code"><a href="#cb139-3"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data    =</span> data_biomass_5country,</span>
<span id="cb139-4" class="hljs-ln-code"><a href="#cb139-4"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, <span class="sc">-</span>biomass, <span class="at">FUN =</span> median), </span>
<span id="cb139-5" class="hljs-ln-code"><a href="#cb139-5"></a>                             <span class="at">y =</span> biomass, </span>
<span id="cb139-6" class="hljs-ln-code"><a href="#cb139-6"></a>                             <span class="at">color =</span> Continent)) <span class="sc">+</span></span>
<span id="cb139-7" class="hljs-ln-code"><a href="#cb139-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>) <span class="sc">+</span> </span>
<span id="cb139-8" class="hljs-ln-code"><a href="#cb139-8"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-168-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="une-petite-subtilité-concernant-les-couleurs-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Une petite subtilité concernant les couleurs</h2>
<div>
<p>Ggplot fait la différence entre :</p>
<ul>
<li class="fragment"><p>la couleur des contours –&gt; <code>color = …</code></p></li>
<li class="fragment"><p>la couleur de remplissage –&gt; <code>fill = …</code></p></li>
</ul>
</div>
<div class="fragment">
<p>Pour choisir ses couleurs de contour <em>vs.</em> de remplissage, on utilise les fonctions <code>scale_color_manual()</code> <em>vs.</em> <code>scale_fill_manual()</code>.</p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb140-1" class="hljs-ln-code"><a href="#cb140-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb140-2" class="hljs-ln-code"><a href="#cb140-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data    =</span> data_biomass_5country,</span>
<span id="cb140-3" class="hljs-ln-code"><a href="#cb140-3"></a>               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, <span class="sc">-</span>biomass, <span class="at">FUN =</span> median), </span>
<span id="cb140-4" class="hljs-ln-code"><a href="#cb140-4"></a>                             <span class="at">y =</span> biomass, </span>
<span id="cb140-5" class="hljs-ln-code"><a href="#cb140-5"></a>                             <span class="at">fill =</span> Continent)) <span class="sc">+</span></span>
<span id="cb140-6" class="hljs-ln-code"><a href="#cb140-6"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, </span>
<span id="cb140-7" class="hljs-ln-code"><a href="#cb140-7"></a>                               <span class="st">"South America"</span> <span class="ot">=</span> <span class="st">"aquamarine"</span>, </span>
<span id="cb140-8" class="hljs-ln-code"><a href="#cb140-8"></a>                               <span class="st">"North America"</span> <span class="ot">=</span> <span class="st">"moccasin"</span>)) <span class="sc">+</span></span>
<span id="cb140-9" class="hljs-ln-code"><a href="#cb140-9"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>) <span class="sc">+</span> </span>
<span id="cb140-10" class="hljs-ln-code"><a href="#cb140-10"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-169-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="une-autre-subtilité-concernant-les-couleurs" class="slide level2">
<h2>Une autre subtilité concernant les couleurs</h2>
<p>Construisons un nuage de points entre la biomasse et la profondeur</p>
<div class="fragment">
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2"></a>  <span class="fu">geom_point</span>(<span class="at">data    =</span> data_biomass_depth,</span>
<span id="cb141-3"><a href="#cb141-3"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x     =</span> depth, </span>
<span id="cb141-4"><a href="#cb141-4"></a>                           <span class="at">y     =</span> biomass,</span>
<span id="cb141-5"><a href="#cb141-5"></a>                           <span class="at">color =</span> biomass)) <span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error: Continuous value supplied to discrete scale</code></pre>
</div>
</div>
</div>
<div class="fragment">
<center>
<p>On ne peut pas donner une seule couleur à une variable continue !</p>
</center></div>
</section>
<section id="couleurs-variables-continues" class="slide level2">
<h2>Couleurs &amp; variables continues</h2>
<p>Il existe 4 fonctions principales qui permettent de construire des palettes de couleurs continues :</p>
<div>
<ul>
<li class="fragment"><p><code>scale_fill_continuous</code> : avec une palette par defaut (nuances de bleus)</p></li>
<li class="fragment"><p><code>scale_fill_viridis_c</code> : Colorblind friendly.</p></li>
<li class="fragment"><p><code>scale_fill_gradient</code> : permet de créer ses propres gradients de couleurs. Des variantes existent selon le nombre de couleurs à définir. Il s’agit de <code>scale_fill_gradient2()</code> et <code>scale_fill_gradientn()</code>.</p></li>
</ul>
</div>
</section>
<section id="couleurs-variables-continues-1" class="slide level2">
<h2>Couleurs &amp; variables continues</h2>
<center>
Testons les une par une à partir de la figure suivante
</center>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(waiting, eruptions, <span class="at">fill =</span> density)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2"></a>  <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb143-4"><a href="#cb143-4"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb143-5"><a href="#cb143-5"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="couleurs-variables-continues-2" class="slide level2">
<h2>Couleurs &amp; variables continues</h2>
<h3 id="scale_color_continuous"><code>scale_color_continuous</code></h3>
<p>La plus simple, mais pas beaucoup d’options. C’est aussi la palette de couleur par défaut.</p>
<div class="fragment">
<div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a>plot</span>
<span id="cb144-2"><a href="#cb144-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_continuous</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-174-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-174-2.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="couleurs-variables-continues-3" class="slide level2">
<h2>Couleurs &amp; variables continues</h2>
<h3 id="scale_color_viridis_c"><code>scale_color_viridis_c</code></h3>
<p>De belles palettes dont les nuances sont captées par les personnes daltoniennes.</p>
<div class="fragment">
<div>
<div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>)</span>
<span id="cb145-2"><a href="#cb145-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"inferno"</span>)</span>
<span id="cb145-3"><a href="#cb145-3"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"turbo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-175-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-175-2.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-175-3.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="info-générale-sur-les-palettes" class="slide level2">
<h2>Info générale sur les palettes</h2>
<p>Petite info utile, toutes les palettes peuvent passer le test <strong><em>ColorBlind Friendly</em></strong> :</p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a>color_pal <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="at">name=</span><span class="st">"Spectral"</span>)</span>
<span id="cb146-2"><a href="#cb146-2"></a>colorBlindness<span class="sc">::</span><span class="fu">displayAllColors</span>(color_pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-176-1.png" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="couleurs-variables-continues-4" class="slide level2 smaller">
<h2>Couleurs &amp; variables continues</h2>
<h3 id="scale_fill_gradient"><code>scale_fill_gradient()</code></h3>
<p>Permet de créer ses propres palettes de couleurs, à partir de 2, 3 ou n couleurs :</p>
<div>
<ul>
<li class="fragment"><p><code>scale_fill_gradient()</code> avec les arguments <code>low</code> et <code>high</code>.</p></li>
<li class="fragment"><p><code>scale_fill_gradient2()</code> avec les arguments <code>low</code>, <code>mid</code> et <code>high</code>.</p></li>
<li class="fragment"><p><code>scale_fill_gradientn()</code> avec l’argument <code>colours</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"darkblue"</span>, <span class="at">high =</span> <span class="st">"darkred"</span>)</span>
<span id="cb147-2"><a href="#cb147-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"darkblue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkred"</span>, <span class="at">midpoint =</span> <span class="fl">0.02</span>)</span>
<span id="cb147-3"><a href="#cb147-3"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> colorspace<span class="sc">::</span><span class="fu">diverge_hcl</span>(<span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-177-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-177-2.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-177-3.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="couleurs-variable-groupée-en-classes" class="slide level2">
<h2>Couleurs &amp; variable groupée en classes</h2>
<p>Il existe 3 fonctions principales qui permettent de construire ce type de palettes de couleurs :</p>
<div>
<ul>
<li class="fragment"><p><code>scale_fill_binned</code> : avec une palette par défaut (nuances de bleus)</p></li>
<li class="fragment"><p><code>scale_fill_fermenter</code> : utilise les <a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">BrewerPalettes</a> (voir <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">ici</a> pour plus d’infos).<br>
Pour voir les palettes =&gt; <code>RColorBrewer::display.brewer.all()</code></p></li>
<li class="fragment"><p><code>scale_fill_steps</code> : permet de créer sa propre palette avec un nombre de classes précis. Des variantes existent selon le nombre de couleurs à définir. Il s’agit de <code>scale_fill_steps2()</code> et <code>scale_fill_stepsn()</code>.</p></li>
</ul>
</div>
</section>
<section id="couleurs-variable-groupée-en-classes-1" class="slide level2">
<h2>Couleurs &amp; variable groupée en classes</h2>
<h3 id="scale_fill_binned"><code>scale_fill_binned()</code></h3>
<p>Les couleurs sont par défaut une nuance de bleus. Certaines précisions peuvent cependant être apportées.</p>
<div class="fragment">
<div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_binned</span>(<span class="at">n.breaks =</span> <span class="dv">4</span>)</span>
<span id="cb148-2"><a href="#cb148-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_binned</span>(<span class="at">n.breaks =</span> <span class="dv">7</span>)</span>
<span id="cb148-3"><a href="#cb148-3"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_binned</span>(<span class="at">breaks =</span> <span class="fu">quantile</span>(faithfuld<span class="sc">$</span>density, <span class="at">probs =</span> (<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-178-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-178-2.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-178-3.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="couleurs-variable-groupée-en-classes-2" class="slide level2 smaller">
<h2>Couleurs &amp; variable groupée en classes</h2>
<h3 id="scale_fill_steps"><code>scale_fill_steps()</code></h3>
<p>Fonction analogue à <code>scale_fill_gradient()</code>.</p>
<div>
<ul>
<li class="fragment"><p><code>scale_fill_steps()</code> avec les arguments <code>low</code> et <code>high</code>.</p></li>
<li class="fragment"><p><code>scale_fill_steps2()</code> avec les arguments <code>low</code>, <code>mid</code> et <code>high</code>.</p></li>
<li class="fragment"><p><code>scale_fill_stepsn()</code> avec l’argument <code>colours</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_steps</span>(<span class="at">low =</span> <span class="st">"darkblue"</span>, <span class="at">high =</span> <span class="st">"darkred"</span>, <span class="at">n.breaks =</span> <span class="dv">8</span>)</span>
<span id="cb149-2"><a href="#cb149-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_steps2</span>(<span class="at">low =</span> <span class="st">"darkblue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkred"</span>, <span class="at">midpoint =</span> <span class="fl">0.02</span>, <span class="at">n.breaks =</span> <span class="dv">8</span>)</span>
<span id="cb149-3"><a href="#cb149-3"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_stepsn</span>(<span class="at">colors =</span> <span class="fu">magma</span>(<span class="dv">9</span>), <span class="at">n.breaks =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-179-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-179-2.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-179-3.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="couleurs-variables-discrètes" class="slide level2">
<h2>Couleurs &amp; variables discrètes</h2>
<p>Les principales fonctions utilisées permettant de construire des palettes de couleurs continues :</p>
<div>
<ul>
<li class="fragment"><p><code>scale_fill_discrete</code> : Couleurs par défaut</p></li>
<li class="fragment"><p><code>scale_fill_manual</code> : choix de la couleur parmi toutes les couleurs existantes.</p></li>
<li class="fragment"><p><code>scale_fill_brewer</code> : utilise les <a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">BrewerPalettes</a> (voir <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">ici</a> pour plus d’infos). Equivalent de <code>scale_fill_distiller</code> pour les variables discrètes.</p></li>
</ul>
</div>
</section>
<section id="couleurs-variables-discrètes-1" class="slide level2">
<h2>Couleurs &amp; variables discrètes</h2>
<div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2"></a>  <span class="fu">geom_violin</span>(<span class="at">data    =</span> data_crabs,</span>
<span id="cb150-3"><a href="#cb150-3"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> CL, <span class="at">fill =</span> sex), </span>
<span id="cb150-4"><a href="#cb150-4"></a>              <span class="at">alpha   =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb150-5"><a href="#cb150-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sp) <span class="sc">+</span></span>
<span id="cb150-6"><a href="#cb150-6"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div>
<div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_discrete</span>()</span>
<span id="cb151-2"><a href="#cb151-2"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>))</span>
<span id="cb151-3"><a href="#cb151-3"></a>plot <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-181-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-181-2.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-181-3.png" width="960"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ressources-utilisées" class="slide level2">
<h2>Ressources utilisées</h2>
<p>https://ggplot2-book.org/scale-colour.html#colour-discrete</p>
<p>https://stackoverflow.com/questions/70942728/understanding-color-scales-in-ggplot2</p>
<p>https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3</p>
</section>
<section id="diagrammes-en-barres-barres-derreurs" class="slide level2">
<h2>Diagrammes en barres &amp; barres d’erreurs</h2>
<p>Pour ajouter les barres d’erreurs, on utilise la fonction <code>geom_errorbar()</code>.</p>
<div class="fragment">
<p>L’utilisation de cette fonction nécessite le calcul préalable de l’écart-type.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a><span class="co"># Formatage des données</span></span>
<span id="cb152-2"><a href="#cb152-2"></a>crabs_mean <span class="ot">&lt;-</span> data_crabs <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3"></a>  <span class="fu">group_by</span>(sp) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4"></a>  <span class="fu">summarise</span>(<span class="at">CL_mean =</span> <span class="fu">mean</span>(CL),</span>
<span id="cb152-5"><a href="#cb152-5"></a>            <span class="at">CL_sd   =</span> <span class="fu">sd</span>(CL)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="co"># Réalisation du diagramme en barres</span></span>
<span id="cb153-2"><a href="#cb153-2"></a><span class="fu">ggplot</span>(crabs_mean) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">y =</span> CL_mean)) <span class="sc">+</span></span>
<span id="cb153-4"><a href="#cb153-4"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> sp, <span class="at">ymin =</span> CL_mean<span class="sc">-</span>CL_sd, <span class="at">ymax =</span> CL_mean<span class="sc">+</span>CL_sd)) <span class="sc">+</span></span>
<span id="cb153-5"><a href="#cb153-5"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-183-1.png" style="width:30.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-5.7" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.7</h2>
<p>A partir des données <strong>data_biomass_5country</strong>, construire un diagramme en barres de la biomasse moyenne par transect. Classer l’axe des x dans l’ordre <strong>croissant</strong>. Trouvez la façon de rendre les barres moins larges et de changer leur couleur.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb154-1" class="hljs-ln-code"><a href="#cb154-1"></a><span class="co"># 1 - Grouper les données par pays</span></span>
<span id="cb154-2" class="hljs-ln-code"><a href="#cb154-2"></a><span class="co"># 2 - Prendre la valeur de biomasse moyenne et l'écart-type de l'ensemble </span></span>
<span id="cb154-3" class="hljs-ln-code"><a href="#cb154-3"></a><span class="co">#     des transects propres à chaque pays</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.7-correction" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.7 : Correction</h2>
<p>A partir des données <strong>data_biomass_5country</strong>, construire un diagramme en barres de la biomasse moyenne par transect. Classer l’axe des x dans l’ordre <strong>croissant</strong>. Trouvez la façon de rendre les barres moins larges et de changer leur couleur.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb155-1" class="hljs-ln-code"><a href="#cb155-1"></a>country_mean <span class="ot">&lt;-</span> data_biomass_5country <span class="sc">%&gt;%</span></span>
<span id="cb155-2" class="hljs-ln-code"><a href="#cb155-2"></a>  <span class="co"># 1 - Grouper les données par pays</span></span>
<span id="cb155-3" class="hljs-ln-code"><a href="#cb155-3"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb155-4" class="hljs-ln-code"><a href="#cb155-4"></a>  <span class="co"># 2 - Prendre la valeur de biomasse moyenne et l'écart-type de l'ensemble </span></span>
<span id="cb155-5" class="hljs-ln-code"><a href="#cb155-5"></a>  <span class="co">#     des transects propres à chaque pays</span></span>
<span id="cb155-6" class="hljs-ln-code"><a href="#cb155-6"></a>  <span class="fu">summarise</span>(<span class="at">biom_mean =</span> <span class="fu">mean</span>(biomass),</span>
<span id="cb155-7" class="hljs-ln-code"><a href="#cb155-7"></a>            <span class="at">biom_sd   =</span> <span class="fu">sd</span>(biomass)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.7-correction-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.7 : Correction</h2>
<p>A partir des données <strong>data_biomass_5country</strong>, construire un diagramme en barres de la biomasse moyenne par transect. Classer l’axe des x dans l’ordre <strong>croissant</strong>. Trouvez la façon de rendre les barres moins larges et de changer leur couleur.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb156-1" class="hljs-ln-code"><a href="#cb156-1"></a><span class="co"># Figure </span></span>
<span id="cb156-2" class="hljs-ln-code"><a href="#cb156-2"></a><span class="fu">ggplot</span>(country_mean) <span class="sc">+</span></span>
<span id="cb156-3" class="hljs-ln-code"><a href="#cb156-3"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, biom_mean), <span class="at">y =</span> biom_mean)) <span class="sc">+</span></span>
<span id="cb156-4" class="hljs-ln-code"><a href="#cb156-4"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">ymin =</span> biom_mean<span class="sc">-</span>biom_sd, <span class="at">ymax =</span> biom_mean<span class="sc">+</span>biom_sd),</span>
<span id="cb156-5" class="hljs-ln-code"><a href="#cb156-5"></a>                    <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb156-6" class="hljs-ln-code"><a href="#cb156-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>) <span class="sc">+</span> </span>
<span id="cb156-7" class="hljs-ln-code"><a href="#cb156-7"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-186-1.png" style="width:70.0%" class="r-stretch quarto-figure-center"></section>
<section id="gestion-des-facteurs-groupes" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Obtient-on les mêmes résultats entre la biomasse totale et l’abondance ?</p>
<div class="fragment">
<h3 id="exercice-5.8">Exercice 5.8</h3>
<p>A partir de <strong>biomass_survey_abundance_exercice3_6</strong>, obtenez un data.frame de trois colonnes <strong>size_class_mm</strong>, <strong>biom_abun</strong>, <strong>value</strong> pour les données prélevées en 2011.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb157-1" class="hljs-ln-code"><a href="#cb157-1"></a> <span class="co"># 1. Enlever la colonne geometry.</span></span>
<span id="cb157-2" class="hljs-ln-code"><a href="#cb157-2"></a> <span class="co"># 2. Filtrer les données 2011.</span></span>
<span id="cb157-3" class="hljs-ln-code"><a href="#cb157-3"></a> <span class="co"># 3. Sélectionner les colonnes size_class_mm, biomass, abundance.</span></span>
<span id="cb157-4" class="hljs-ln-code"><a href="#cb157-4"></a> <span class="co"># 4. Transformer la colonne size_class_mm en facteur.</span></span>
<span id="cb157-5" class="hljs-ln-code"><a href="#cb157-5"></a> <span class="co"># 5. Sommer la biomass et l'abondunce par classe de taille.</span></span>
<span id="cb157-6" class="hljs-ln-code"><a href="#cb157-6"></a> <span class="co"># 6. Pivoter le tableau au format long en gardant size_class_mm.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="gestion-des-facteurs-groupes-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Obtient-on les mêmes résultats entre la biomasse totale et l’abondance ?</p>
<h3 id="exercice-5.8-correction">Exercice 5.8 : Correction</h3>
<p>A partir de <strong>biomass_survey_abundance_exercice3_6</strong>, obtenez un data.frame de trois colonnes <strong>size_class_mm</strong>, <strong>biom_abun</strong>, <strong>value</strong> pour les données prélevées en 2011.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb158-1" class="hljs-ln-code"><a href="#cb158-1"></a>biomass_abundance <span class="ot">&lt;-</span> biomass_survey_abundance_exercice3_6 <span class="sc">%&gt;%</span></span>
<span id="cb158-2" class="hljs-ln-code"><a href="#cb158-2"></a>  <span class="co"># 1. Enlever la colonne geometry.</span></span>
<span id="cb158-3" class="hljs-ln-code"><a href="#cb158-3"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb158-4" class="hljs-ln-code"><a href="#cb158-4"></a>  <span class="co"># 2. Filtrer les données 2011.</span></span>
<span id="cb158-5" class="hljs-ln-code"><a href="#cb158-5"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="at">string =</span> survey_date, <span class="at">pattern =</span> <span class="st">"2011"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-6" class="hljs-ln-code"><a href="#cb158-6"></a>  <span class="co"># 3. Sélectionner les colonnes size_class_mm, biomass, abundance.</span></span>
<span id="cb158-7" class="hljs-ln-code"><a href="#cb158-7"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(size_class_mm, biomass, abundance) <span class="sc">%&gt;%</span></span>
<span id="cb158-8" class="hljs-ln-code"><a href="#cb158-8"></a>  <span class="co"># 4. Transformer la colonne size_class_mm en facteur.</span></span>
<span id="cb158-9" class="hljs-ln-code"><a href="#cb158-9"></a>  <span class="fu">mutate</span>(<span class="at">size_class_mm =</span> <span class="fu">as.factor</span>(size_class_mm)) <span class="sc">%&gt;%</span></span>
<span id="cb158-10" class="hljs-ln-code"><a href="#cb158-10"></a>  <span class="co"># 5. Sommer la biomass et l'abondunce par classe de taille.</span></span>
<span id="cb158-11" class="hljs-ln-code"><a href="#cb158-11"></a>  <span class="fu">group_by</span>(size_class_mm) <span class="sc">%&gt;%</span></span>
<span id="cb158-12" class="hljs-ln-code"><a href="#cb158-12"></a>  <span class="fu">summarise_all</span>(sum) <span class="sc">%&gt;%</span></span>
<span id="cb158-13" class="hljs-ln-code"><a href="#cb158-13"></a>  <span class="co"># 6. Pivoter le tableau au format long en gardant size_class_mm.</span></span>
<span id="cb158-14" class="hljs-ln-code"><a href="#cb158-14"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">names_to =</span> <span class="st">"biom_abun"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gestion-des-facteurs-groupes-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Construisons un diagramme en barres de la biomasse/abondance avec une couleur par classe de taille.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb159-1" class="hljs-ln-code"><a href="#cb159-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance,</span>
<span id="cb159-2" class="hljs-ln-code"><a href="#cb159-2"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> biom_abun, </span>
<span id="cb159-3" class="hljs-ln-code"><a href="#cb159-3"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb159-4" class="hljs-ln-code"><a href="#cb159-4"></a>                     <span class="at">fill =</span> size_class_mm)) <span class="sc">+</span></span>
<span id="cb159-5" class="hljs-ln-code"><a href="#cb159-5"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-189-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="gestion-des-facteurs-groupes-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Construisons un diagramme en barres de la biomasse/abondance avec une couleur par classe de taille.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb160-1" class="hljs-ln-code"><a href="#cb160-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance,</span>
<span id="cb160-2" class="hljs-ln-code"><a href="#cb160-2"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> biom_abun, </span>
<span id="cb160-3" class="hljs-ln-code"><a href="#cb160-3"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb160-4" class="hljs-ln-code"><a href="#cb160-4"></a>                     <span class="at">fill =</span> size_class_mm)) <span class="sc">+</span></span>
<span id="cb160-5" class="hljs-ln-code"><a href="#cb160-5"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, </span>
<span id="cb160-6" class="hljs-ln-code"><a href="#cb160-6"></a>           <span class="at">stat     =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-190-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"></section>
<section id="gestion-des-facteurs-groupes-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Construisons un diagramme en barres de la biomasse/abondance avec une couleur par classe de taille.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb161-1" class="hljs-ln-code"><a href="#cb161-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance,</span>
<span id="cb161-2" class="hljs-ln-code"><a href="#cb161-2"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> biom_abun, </span>
<span id="cb161-3" class="hljs-ln-code"><a href="#cb161-3"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb161-4" class="hljs-ln-code"><a href="#cb161-4"></a>                     <span class="at">fill =</span> size_class_mm)) <span class="sc">+</span></span>
<span id="cb161-5" class="hljs-ln-code"><a href="#cb161-5"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>, <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb161-6" class="hljs-ln-code"><a href="#cb161-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>, <span class="at">fill =</span> <span class="st">"Size class (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb161-7" class="hljs-ln-code"><a href="#cb161-7"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"[0, 25["</span>, <span class="st">"[25, 50["</span>, <span class="st">"[50, 75["</span>, <span class="st">"[75, 100["</span>)) <span class="sc">+</span></span>
<span id="cb161-8" class="hljs-ln-code"><a href="#cb161-8"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-191-1.png" style="width:70.0%" class="r-stretch quarto-figure-center"></section>
<section id="gestion-des-facteurs-groupes-5" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Changeons l’ordre des facteurs de façon à ce que la classe [75,100[ soit en 1ère.</p>
<div class="cell" data-warnings="false">

</div>
<div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb162-1" class="hljs-ln-code"><a href="#cb162-1"></a>plot1</span>
<span id="cb162-2" class="hljs-ln-code"><a href="#cb162-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance,</span>
<span id="cb162-3" class="hljs-ln-code"><a href="#cb162-3"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> biom_abun, </span>
<span id="cb162-4" class="hljs-ln-code"><a href="#cb162-4"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb162-5" class="hljs-ln-code"><a href="#cb162-5"></a>                     <span class="at">fill =</span> <span class="fu">rev</span>(size_class_mm))) <span class="sc">+</span></span>
<span id="cb162-6" class="hljs-ln-code"><a href="#cb162-6"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>, <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb162-7" class="hljs-ln-code"><a href="#cb162-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>, <span class="at">fill =</span> <span class="st">"Size class (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb162-8" class="hljs-ln-code"><a href="#cb162-8"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">labels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"[0, 25["</span>, <span class="st">"[25, 50["</span>, <span class="st">"[50, 75["</span>, <span class="st">"[75, 100["</span>))) <span class="sc">+</span></span>
<span id="cb162-9" class="hljs-ln-code"><a href="#cb162-9"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-193-1.png" width="960"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-193-2.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="gestion-des-facteurs-groupes-6" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Gestion des facteurs &amp; groupes</h2>
<p>Changeons l’ordre des facteurs de façon à ce que la classe [75,100[ soit en 1ère.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb163-1" class="hljs-ln-code"><a href="#cb163-1"></a>biomass_abundance2 <span class="ot">&lt;-</span> biomass_abundance <span class="sc">%&gt;%</span></span>
<span id="cb163-2" class="hljs-ln-code"><a href="#cb163-2"></a>  <span class="fu">mutate</span>(<span class="at">size_class_mm =</span> <span class="fu">factor</span>(<span class="at">x      =</span> biomass_abundance<span class="sc">$</span>size_class_mm, </span>
<span id="cb163-3" class="hljs-ln-code"><a href="#cb163-3"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"100"</span>, <span class="st">"75"</span>, <span class="st">"50"</span>, <span class="st">"25"</span>))) </span>
<span id="cb163-4" class="hljs-ln-code"><a href="#cb163-4"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance2,</span>
<span id="cb163-5" class="hljs-ln-code"><a href="#cb163-5"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> biom_abun, </span>
<span id="cb163-6" class="hljs-ln-code"><a href="#cb163-6"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb163-7" class="hljs-ln-code"><a href="#cb163-7"></a>                     <span class="at">fill =</span> size_class_mm)) <span class="sc">+</span></span>
<span id="cb163-8" class="hljs-ln-code"><a href="#cb163-8"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb163-9" class="hljs-ln-code"><a href="#cb163-9"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>, <span class="at">fill =</span> <span class="st">"Size class (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb163-10" class="hljs-ln-code"><a href="#cb163-10"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"[75, 100["</span>, <span class="st">"[50, 75["</span>, <span class="st">"[25, 50["</span>,  <span class="st">"[0, 25["</span>)) <span class="sc">+</span></span>
<span id="cb163-11" class="hljs-ln-code"><a href="#cb163-11"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-194-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.8-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.8</h2>
<p>Réaliser un diagramme en barres permettant d’illustrer le mieux les cas où l’abondance est supérieure à la biomasse et vice-versa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb164-1" class="hljs-ln-code"><a href="#cb164-1"></a><span class="co"># Correction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.8-correction-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.8 : Correction</h2>
<p>Réaliser un diagramme en barres permettant d’illustrer le mieux les cas où l’abondance est supérieure à la biomasse et vice-versa.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb165-1" class="hljs-ln-code"><a href="#cb165-1"></a><span class="co"># Correction</span></span>
<span id="cb165-2" class="hljs-ln-code"><a href="#cb165-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> biomass_abundance,</span>
<span id="cb165-3" class="hljs-ln-code"><a href="#cb165-3"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x    =</span> size_class_mm, </span>
<span id="cb165-4" class="hljs-ln-code"><a href="#cb165-4"></a>                     <span class="at">y    =</span> value, </span>
<span id="cb165-5" class="hljs-ln-code"><a href="#cb165-5"></a>                     <span class="at">fill =</span> biom_abun)) <span class="sc">+</span></span>
<span id="cb165-6" class="hljs-ln-code"><a href="#cb165-6"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>, <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb165-7" class="hljs-ln-code"><a href="#cb165-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Size class (mm)"</span>, <span class="at">y =</span> <span class="st">"Biomass (g)"</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb165-8" class="hljs-ln-code"><a href="#cb165-8"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Abundance"</span>, <span class="st">"Biomass"</span>)) <span class="sc">+</span></span>
<span id="cb165-9" class="hljs-ln-code"><a href="#cb165-9"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-196-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="la-cartographie-avec-ggplot2" class="slide level2 smaller">
<h2>La cartographie avec ggplot2</h2>
<h3 id="une-petite-introduction-pour-commencer">Une petite introduction pour commencer</h3>
<h3 id="les-données-géographiques">Les données géographiques</h3>
<p>Ce sont des données ayant une localisation dans l’espace. On peut les représenter et les visualiser sur une carte. Pour les répresenter il existe deux formats principaux : le vecteur et le raster.</p>
<h3 id="un-raster-cest-quoi">Un raster c’est quoi ?</h3>
<p>Un raster est une image dans laquelle chaque pixel a une seule valeur et est géo-référencé. Chaque pixel a la même taille et la résolution dépend du nombre de pixel. Sous R, il existe une librairie spécialement développée pour traiter des fichiers raster. c’est la librairie <code>raster</code></p>
<h3 id="un-vecteur-cest-quoi">Un vecteur c’est quoi ?</h3>
<p>Un vecteur est composé de 2 éléments principaux:</p>
<ul>
<li><p>la <strong>table attributaire</strong> : permet de décrire les informations qui lui sont associées. Le nombre d’informations n’est pas limitée</p></li>
<li><p>la <strong>partie graphique</strong> (sa forme) : il existe trois types de géometrie pour définir les vecteurs (point, ligne, polygone)</p></li>
</ul>
<p>L’ensemble de ces composantes (informations, géométrie, projection, …) forme un objet que l’on appelle shapefile. La librairie <code>sf</code> permet de gérer les formats vecteur sous R.</p>
<p>Pour plus d’informations détaillées <a href="https://naturagis.fr/cartographie-sig/difference-vecteur-raster/">cliquez ici</a></p>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
<ul>
<li>Plotter des données spatialisées</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a><span class="co"># Pour les objets spatialisés de type vectoriel au format sf</span></span>
<span id="cb166-2"><a href="#cb166-2"></a><span class="fu">geom_sf</span>()</span>
<span id="cb166-3"><a href="#cb166-3"></a><span class="co"># Permet d'extraire les coordonnées d'un objet sf</span></span>
<span id="cb166-4"><a href="#cb166-4"></a><span class="fu">stat_sf_coordinates</span>()</span>
<span id="cb166-5"><a href="#cb166-5"></a><span class="co"># Pour les objets spatialisés au format raster</span></span>
<span id="cb166-6"><a href="#cb166-6"></a><span class="fu">geom_raster</span>()</span>
<span id="cb166-7"><a href="#cb166-7"></a><span class="co"># Attention geom_raster ne reçoit pas un objet directement au format raster </span></span>
<span id="cb166-8"><a href="#cb166-8"></a><span class="co"># mais un data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-11" class="slide level2 smaller">
<h2></h2>
<h3 id="applications-geom_sf">Applications : geom_sf</h3>
<ul>
<li>Charger les données et visualiser la carte</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="co"># Pour cette partie nous utiliserons un shapefile des pays de la librarie rnaturalearth</span></span>
<span id="cb167-2"><a href="#cb167-2"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb167-3"><a href="#cb167-3"></a><span class="co"># install.packages("rnaturalearthdata")</span></span>
<span id="cb167-4"><a href="#cb167-4"></a>world_boundaries <span class="ot">&lt;-</span></span>
<span id="cb167-5"><a href="#cb167-5"></a>  <span class="fu">ne_countries</span>(<span class="at">returnclass =</span> <span class="st">"sf"</span>, <span class="at">scale =</span> <span class="st">"medium"</span>)</span>
<span id="cb167-6"><a href="#cb167-6"></a><span class="co"># dim(world_boundaries)</span></span>
<span id="cb167-7"><a href="#cb167-7"></a><span class="co"># head(world_boundaries)</span></span>
<span id="cb167-8"><a href="#cb167-8"></a>map1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> world_boundaries) <span class="sc">+</span></span>
<span id="cb167-9"><a href="#cb167-9"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb167-10"><a href="#cb167-10"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb167-11"><a href="#cb167-11"></a>map1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-198-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-12" class="slide level2 smaller">
<h2></h2>
<h3 id="applications-stat_sf_coordinates">Applications : stat_sf_coordinates</h3>
<ul>
<li>Afficher sur chaque pays un rond dont la taille est proportionnelle à la population et la couleur fonction du GDP</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>map2 <span class="ot">&lt;-</span> map1 <span class="sc">+</span></span>
<span id="cb168-2"><a href="#cb168-2"></a>  <span class="fu">stat_sf_coordinates</span>(</span>
<span id="cb168-3"><a href="#cb168-3"></a>    <span class="fu">aes</span>(<span class="at">size =</span> pop_est, <span class="at">fill =</span> gdp_md_est),</span>
<span id="cb168-4"><a href="#cb168-4"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb168-5"><a href="#cb168-5"></a>    <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb168-6"><a href="#cb168-6"></a>    <span class="at">data =</span> world_boundaries</span>
<span id="cb168-7"><a href="#cb168-7"></a>  ) <span class="sc">+</span></span>
<span id="cb168-8"><a href="#cb168-8"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"GDP"</span>) <span class="sc">+</span></span>
<span id="cb168-9"><a href="#cb168-9"></a>  <span class="fu">scale_size_binned</span>(<span class="at">breaks =</span> <span class="fu">quantile</span>(</span>
<span id="cb168-10"><a href="#cb168-10"></a>    world_boundaries<span class="sc">$</span>pop_est,</span>
<span id="cb168-11"><a href="#cb168-11"></a>    <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb168-12"><a href="#cb168-12"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb168-13"><a href="#cb168-13"></a>  )) <span class="sc">+</span></span>
<span id="cb168-14"><a href="#cb168-14"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb168-15"><a href="#cb168-15"></a>map2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-199-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-13" class="slide level2 smaller">
<h2></h2>
<h3 id="applications-geom_raster">Applications : geom_raster</h3>
<ul>
<li>Créer un raster et le visualiser</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncols =</span> <span class="dv">5</span>, <span class="at">nrows =</span> <span class="dv">5</span>) <span class="co"># Création d'un raster vide</span></span>
<span id="cb169-2"><a href="#cb169-2"></a>r1 <span class="ot">&lt;-</span> <span class="fu">setValues</span>(r, <span class="fu">runif</span>(<span class="fu">ncell</span>(r))) <span class="co"># Remplissage du raster avec des valeurs</span></span>
<span id="cb169-3"><a href="#cb169-3"></a>rastdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r1, <span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="co"># Transformation du raster en data frame</span></span>
<span id="cb169-4"><a href="#cb169-4"></a>map3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb169-5"><a href="#cb169-5"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> rastdf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y))</span>
<span id="cb169-6"><a href="#cb169-6"></a>map3<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-200-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-14" class="slide level2">
<h2></h2>
<h3 id="applications-geom_raster-1">Applications : geom_raster</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a>map3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb170-2"><a href="#cb170-2"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> rastdf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> layer)) <span class="co"># Ajout de l'argument fill</span></span>
<span id="cb170-3"><a href="#cb170-3"></a>map3<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-201-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-15" class="slide level2">
<h2></h2>
<ul>
<li>Ajouter des étiquettes et du texte</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a><span class="co"># Afficher du texte</span></span>
<span id="cb171-2"><a href="#cb171-2"></a><span class="fu">geom_sf_text</span>()</span>
<span id="cb171-3"><a href="#cb171-3"></a><span class="co"># Afficher des étiquettes</span></span>
<span id="cb171-4"><a href="#cb171-4"></a><span class="fu">geom_sf_label</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-16" class="slide level2">
<h2></h2>
<h3 id="applications-geom_sf_text">Applications : geom_sf_text</h3>
<ul>
<li>Afficher sous format texte le code ISO3 des pays</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a>map4<span class="fl">.1</span> <span class="ot">&lt;-</span> map1 <span class="sc">+</span></span>
<span id="cb172-2"><a href="#cb172-2"></a>  <span class="fu">geom_sf_text</span>(</span>
<span id="cb172-3"><a href="#cb172-3"></a>    <span class="fu">aes</span>(<span class="at">label =</span> adm0_a3),</span>
<span id="cb172-4"><a href="#cb172-4"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb172-5"><a href="#cb172-5"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb172-6"><a href="#cb172-6"></a>    <span class="at">colour =</span> <span class="st">"blue"</span></span>
<span id="cb172-7"><a href="#cb172-7"></a>  ) <span class="sc">+</span></span>
<span id="cb172-8"><a href="#cb172-8"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb172-9"><a href="#cb172-9"></a>map4<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-203-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-17" class="slide level2">
<h2></h2>
<h3 id="applications-geom_sf_text-1">Applications : geom_sf_text</h3>
<ul>
<li>Afficher sous format texte le code ISO3 des pays</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>map4<span class="fl">.2</span> <span class="ot">&lt;-</span> map1 <span class="sc">+</span></span>
<span id="cb173-2"><a href="#cb173-2"></a>  <span class="fu">geom_sf_text</span>(</span>
<span id="cb173-3"><a href="#cb173-3"></a>    <span class="fu">aes</span>(<span class="at">label =</span> adm0_a3),</span>
<span id="cb173-4"><a href="#cb173-4"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb173-5"><a href="#cb173-5"></a>    <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb173-6"><a href="#cb173-6"></a>    <span class="at">fontface =</span> <span class="st">"italic"</span>,</span>
<span id="cb173-7"><a href="#cb173-7"></a>    <span class="at">colour =</span> <span class="st">"blue"</span></span>
<span id="cb173-8"><a href="#cb173-8"></a>  ) <span class="sc">+</span></span>
<span id="cb173-9"><a href="#cb173-9"></a>  <span class="co"># Ajout de l'argument check_overlap = TRUE</span></span>
<span id="cb173-10"><a href="#cb173-10"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb173-11"><a href="#cb173-11"></a>map4<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-204-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-18" class="slide level2">
<h2></h2>
<h3 id="applications-geom_sf_label">Applications : geom_sf_label</h3>
<ul>
<li>Afficher sous format étiquette le code ISO3 des pays</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a>map5 <span class="ot">&lt;-</span> map1 <span class="sc">+</span></span>
<span id="cb174-2"><a href="#cb174-2"></a>  <span class="fu">geom_sf_label</span>(</span>
<span id="cb174-3"><a href="#cb174-3"></a>    <span class="fu">aes</span>(<span class="at">label =</span> adm0_a3),</span>
<span id="cb174-4"><a href="#cb174-4"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb174-5"><a href="#cb174-5"></a>    <span class="at">colour =</span> <span class="st">"blue"</span>,</span>
<span id="cb174-6"><a href="#cb174-6"></a>    <span class="at">fill =</span> <span class="st">"cyan"</span></span>
<span id="cb174-7"><a href="#cb174-7"></a>  ) <span class="sc">+</span></span>
<span id="cb174-8"><a href="#cb174-8"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb174-9"><a href="#cb174-9"></a>map5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-205-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-19" class="slide level2">
<h2></h2>
<ul>
<li>Peaufiner les cartes avec la librairie <code>ggspatial</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a><span class="co"># Ajout de la barre d'échelle</span></span>
<span id="cb175-2"><a href="#cb175-2"></a><span class="fu">annotation_scale</span>()</span>
<span id="cb175-3"><a href="#cb175-3"></a><span class="co"># Ajout de la flèche du nord</span></span>
<span id="cb175-4"><a href="#cb175-4"></a><span class="fu">annotation_north_arrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-20" class="slide level2">
<h2></h2>
<h3 id="application-annotation_scale">Application : annotation_scale</h3>
<ul>
<li>Ajouter la barre d’échelle</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1"></a>map6<span class="fl">.1</span> <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb176-2"><a href="#cb176-2"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb176-3"><a href="#cb176-3"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"br"</span>, <span class="at">line_width =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb176-4"><a href="#cb176-4"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb176-5"><a href="#cb176-5"></a>map6<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-207-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="section-21" class="slide level2">
<h2></h2>
<h3 id="application-annotation_north_arrow">Application : annotation_north_arrow</h3>
<ul>
<li>Ajouter la flèche du nord</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a>map6<span class="fl">.2</span> <span class="ot">&lt;-</span> map5 <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2"></a>  <span class="fu">annotation_north_arrow</span>(</span>
<span id="cb177-3"><a href="#cb177-3"></a>    <span class="at">location =</span> <span class="st">"tl"</span>,</span>
<span id="cb177-4"><a href="#cb177-4"></a>    <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"cm"</span>),</span>
<span id="cb177-5"><a href="#cb177-5"></a>    <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"cm"</span>)</span>
<span id="cb177-6"><a href="#cb177-6"></a>  )</span>
<span id="cb177-7"><a href="#cb177-7"></a>map6<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-208-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.9" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.9</h2>
<ul>
<li>Construisez une carte des transects en Méditerranée avec une couleur par profondeur. Choisissez une palette de couleurs cohérente avec les données</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb178-1" class="hljs-ln-code"><a href="#cb178-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.9-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.9 corrigé</h2>
<ul>
<li>Construisez une carte des transects en Méditerranée avec une couleur par profondeur. Choisissez une palette de couleurs cohérente avec les données</li>
</ul>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb179-1" class="hljs-ln-code"><a href="#cb179-1"></a><span class="co"># solution</span></span>
<span id="cb179-2" class="hljs-ln-code"><a href="#cb179-2"></a>med_map1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> survey_med) <span class="sc">+</span></span>
<span id="cb179-3" class="hljs-ln-code"><a href="#cb179-3"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> depth)) <span class="sc">+</span></span>
<span id="cb179-4" class="hljs-ln-code"><a href="#cb179-4"></a>  <span class="fu">scale_colour_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb179-5" class="hljs-ln-code"><a href="#cb179-5"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb179-6" class="hljs-ln-code"><a href="#cb179-6"></a>med_map1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-211-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.10" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.10</h2>
<ul>
<li>Ajoutez au résultat précédent un fond de carte avec les pays en gris clair (gray92)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb180-1" class="hljs-ln-code"><a href="#cb180-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.10-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.10 corrigé</h2>
<ul>
<li>Ajoutez au résultat précédent un fond de carte avec les pays en gris clair (gray92)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb181-1" class="hljs-ln-code"><a href="#cb181-1"></a><span class="co"># solution</span></span>
<span id="cb181-2" class="hljs-ln-code"><a href="#cb181-2"></a>med_map2 <span class="ot">&lt;-</span> med_map1  <span class="sc">+</span></span>
<span id="cb181-3" class="hljs-ln-code"><a href="#cb181-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world_boundaries, <span class="at">fill =</span> <span class="st">"gray92"</span>)</span>
<span id="cb181-4" class="hljs-ln-code"><a href="#cb181-4"></a>med_map2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-213-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.11" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.11</h2>
<ul>
<li>Recentrez la carte autour des pays d’intérêt (xmin=-20, xmax=60, ymin=25, ymax=45)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb182-1" class="hljs-ln-code"><a href="#cb182-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.11-corrigé" class="slide level2 smaller" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.11 corrigé</h2>
<ul>
<li>Recentrez la carte autour des pays d’intérêt (xmin=-20, xmax=60, ymin=25, ymax=45)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb183-1" class="hljs-ln-code"><a href="#cb183-1"></a><span class="co"># solution</span></span>
<span id="cb183-2" class="hljs-ln-code"><a href="#cb183-2"></a>med_map3 <span class="ot">&lt;-</span> med_map2  <span class="sc">+</span></span>
<span id="cb183-3" class="hljs-ln-code"><a href="#cb183-3"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb183-4" class="hljs-ln-code"><a href="#cb183-4"></a>  <span class="fu">ylim</span>(<span class="dv">25</span>, <span class="dv">45</span>)</span>
<span id="cb183-5" class="hljs-ln-code"><a href="#cb183-5"></a>med_map3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-215-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.12" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.12</h2>
<ul>
<li>Pour chaque pays, ajoutez un cercle proportionnel au nombre de transects réalisés sur ses côtes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb184-1" class="hljs-ln-code"><a href="#cb184-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.12-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.12 corrigé</h2>
<ul>
<li>Pour chaque pays, ajoutez un cercle proportionnel au nombre de transects réalisés sur ses côtes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb185-1" class="hljs-ln-code"><a href="#cb185-1"></a><span class="co"># solution</span></span>
<span id="cb185-2" class="hljs-ln-code"><a href="#cb185-2"></a>survey_med_nsample <span class="ot">&lt;-</span> survey_med <span class="sc">%&gt;%</span></span>
<span id="cb185-3" class="hljs-ln-code"><a href="#cb185-3"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb185-4" class="hljs-ln-code"><a href="#cb185-4"></a>  <span class="fu">mutate</span>(<span class="at">n_sample =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb185-5" class="hljs-ln-code"><a href="#cb185-5"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-6" class="hljs-ln-code"><a href="#cb185-6"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-7" class="hljs-ln-code"><a href="#cb185-7"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(country, n_sample))</span>
<span id="cb185-8" class="hljs-ln-code"><a href="#cb185-8"></a>country_med_nsample <span class="ot">&lt;-</span></span>
<span id="cb185-9" class="hljs-ln-code"><a href="#cb185-9"></a>  <span class="fu">left_join</span>(world_boundaries, survey_med_nsample, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="st">"country"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb185-10" class="hljs-ln-code"><a href="#cb185-10"></a>  <span class="fu">drop_na</span>(n_sample)</span>
<span id="cb185-11" class="hljs-ln-code"><a href="#cb185-11"></a>med_map4 <span class="ot">&lt;-</span> med_map3 <span class="sc">+</span></span>
<span id="cb185-12" class="hljs-ln-code"><a href="#cb185-12"></a>  <span class="fu">stat_sf_coordinates</span>(</span>
<span id="cb185-13" class="hljs-ln-code"><a href="#cb185-13"></a>    <span class="fu">aes</span>(<span class="at">size =</span> n_sample),</span>
<span id="cb185-14" class="hljs-ln-code"><a href="#cb185-14"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb185-15" class="hljs-ln-code"><a href="#cb185-15"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb185-16" class="hljs-ln-code"><a href="#cb185-16"></a>    <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb185-17" class="hljs-ln-code"><a href="#cb185-17"></a>    <span class="at">data =</span> country_med_nsample</span>
<span id="cb185-18" class="hljs-ln-code"><a href="#cb185-18"></a>  )</span>
<span id="cb185-19" class="hljs-ln-code"><a href="#cb185-19"></a>med_map4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.12-corrigé-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.12 corrigé</h2>

<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-218-1.png" width="960" class="r-stretch"></section>
<section id="exercice-5.13" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.13</h2>
<ul>
<li>Ajoutez la carte de bathymétrie. Pour la charger, utilisez la commande raster::raster(“./data/bathy_med.tif”). Que remarquez vous ?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb186-1" class="hljs-ln-code"><a href="#cb186-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.13-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.13 corrigé</h2>
<ul>
<li>Ajoutez la carte de bathymétrie. Pour la charger, utilisez la commande raster::raster(“./data/bathy_med.tif”). Que remarquez vous ?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb187-1" class="hljs-ln-code"><a href="#cb187-1"></a><span class="co"># solution</span></span>
<span id="cb187-2" class="hljs-ln-code"><a href="#cb187-2"></a>bathy_med <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">raster</span>(<span class="st">"./data/bathy_med.tif"</span>)</span>
<span id="cb187-3" class="hljs-ln-code"><a href="#cb187-3"></a>rastdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bathy_med, <span class="at">xy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb187-4" class="hljs-ln-code"><a href="#cb187-4"></a>med_map5 <span class="ot">&lt;-</span></span>
<span id="cb187-5" class="hljs-ln-code"><a href="#cb187-5"></a>  med_map4 <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="at">data =</span> rastdf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> bathy_med))</span>
<span id="cb187-6" class="hljs-ln-code"><a href="#cb187-6"></a>med_map5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.13-corrigé-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.13 corrigé</h2>

<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-221-1.png" width="960" class="r-stretch quarto-figure-center"><br>
<center>
Importance dans l’ordre d’ajout des couches
<center>
</center></center></section>
<section id="exercice-5.13-corrigé-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.13 corrigé</h2>
<ul>
<li>Ajoutez la carte de bathymétrie. Pour la charger, utilisez la commande raster::raster(“./data/bathy_med.tif”). Que remarquez vous ?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb188-1" class="hljs-ln-code"><a href="#cb188-1"></a><span class="co"># solution</span></span>
<span id="cb188-2" class="hljs-ln-code"><a href="#cb188-2"></a>bathy_med <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">raster</span>(<span class="st">"./data/bathy_med.tif"</span>)</span>
<span id="cb188-3" class="hljs-ln-code"><a href="#cb188-3"></a>rastdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(bathy_med, <span class="at">xy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb188-4" class="hljs-ln-code"><a href="#cb188-4"></a>med_map5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> survey_med) <span class="sc">+</span></span>
<span id="cb188-5" class="hljs-ln-code"><a href="#cb188-5"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> rastdf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> bathy_med)) <span class="sc">+</span></span>
<span id="cb188-6" class="hljs-ln-code"><a href="#cb188-6"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world_boundaries, <span class="at">fill =</span> <span class="st">"gray92"</span>)  <span class="sc">+</span></span>
<span id="cb188-7" class="hljs-ln-code"><a href="#cb188-7"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> depth)) <span class="sc">+</span></span>
<span id="cb188-8" class="hljs-ln-code"><a href="#cb188-8"></a>  <span class="fu">scale_colour_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb188-9" class="hljs-ln-code"><a href="#cb188-9"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb188-10" class="hljs-ln-code"><a href="#cb188-10"></a>  <span class="fu">ylim</span>(<span class="dv">25</span>, <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb188-11" class="hljs-ln-code"><a href="#cb188-11"></a>  <span class="fu">stat_sf_coordinates</span>(</span>
<span id="cb188-12" class="hljs-ln-code"><a href="#cb188-12"></a>    <span class="fu">aes</span>(<span class="at">size =</span> n_sample),</span>
<span id="cb188-13" class="hljs-ln-code"><a href="#cb188-13"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb188-14" class="hljs-ln-code"><a href="#cb188-14"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb188-15" class="hljs-ln-code"><a href="#cb188-15"></a>    <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb188-16" class="hljs-ln-code"><a href="#cb188-16"></a>    <span class="at">data =</span> country_med_nsample</span>
<span id="cb188-17" class="hljs-ln-code"><a href="#cb188-17"></a>  ) <span class="sc">+</span></span>
<span id="cb188-18" class="hljs-ln-code"><a href="#cb188-18"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb188-19" class="hljs-ln-code"><a href="#cb188-19"></a>med_map5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.13-corrigé-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.13 corrigé</h2>

<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-223-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.14" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.14</h2>
<ul>
<li>Customisez la carte avec la flêche du Nord, le nom des axes et un titre. Renommez la légende et ajoutez une palette de couleurs distinguant terre et mer pour la bathymétrie</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb189-1" class="hljs-ln-code"><a href="#cb189-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.14-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.14 corrigé</h2>
<ul>
<li>Customisez la carte avec la flêche du Nord, le nom des axes et un titre. Renommez la légende et ajoutez une palette de couleurs distinguant terre et mer pour la bathymétrie</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb190-1" class="hljs-ln-code"><a href="#cb190-1"></a><span class="co"># solution</span></span>
<span id="cb190-2" class="hljs-ln-code"><a href="#cb190-2"></a>med_map6 <span class="ot">&lt;-</span> med_map5 <span class="sc">+</span></span>
<span id="cb190-3" class="hljs-ln-code"><a href="#cb190-3"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"brown"</span>) <span class="sc">+</span></span>
<span id="cb190-4" class="hljs-ln-code"><a href="#cb190-4"></a>  <span class="fu">annotation_north_arrow</span>(</span>
<span id="cb190-5" class="hljs-ln-code"><a href="#cb190-5"></a>    <span class="at">location =</span> <span class="st">"tl"</span>,</span>
<span id="cb190-6" class="hljs-ln-code"><a href="#cb190-6"></a>    <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"cm"</span>),</span>
<span id="cb190-7" class="hljs-ln-code"><a href="#cb190-7"></a>    <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="st">"cm"</span>)</span>
<span id="cb190-8" class="hljs-ln-code"><a href="#cb190-8"></a>  ) <span class="sc">+</span></span>
<span id="cb190-9" class="hljs-ln-code"><a href="#cb190-9"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"longitude"</span>,</span>
<span id="cb190-10" class="hljs-ln-code"><a href="#cb190-10"></a>       <span class="at">y =</span> <span class="st">"latitude"</span>,</span>
<span id="cb190-11" class="hljs-ln-code"><a href="#cb190-11"></a>       <span class="at">title =</span> <span class="st">"RLS mediterranean survey"</span>,</span>
<span id="cb190-12" class="hljs-ln-code"><a href="#cb190-12"></a>       <span class="at">fill =</span> <span class="st">"bathymétrie"</span>)</span>
<span id="cb190-13" class="hljs-ln-code"><a href="#cb190-13"></a>med_map6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.14-corrigé-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.14 corrigé</h2>

<img data-src="tidyverse-training_files/figure-revealjs/unnamed-chunk-226-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="exercice-5.15" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.15</h2>
<ul>
<li>Sauvegardez votre belle carte :)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb191-1" class="hljs-ln-code"><a href="#cb191-1"></a><span class="co"># solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-5.15-corrigé" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Exercice 5.15 corrigé</h2>
<ul>
<li>Sauvegardez votre belle carte :)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb192-1" class="hljs-ln-code"><a href="#cb192-1"></a><span class="co"># solution</span></span>
<span id="cb192-2" class="hljs-ln-code"><a href="#cb192-2"></a><span class="fu">ggsave</span>(</span>
<span id="cb192-3" class="hljs-ln-code"><a href="#cb192-3"></a>  <span class="st">"./figures/RLS_med.pdf"</span>,</span>
<span id="cb192-4" class="hljs-ln-code"><a href="#cb192-4"></a>  <span class="at">plot =</span> med_map6,</span>
<span id="cb192-5" class="hljs-ln-code"><a href="#cb192-5"></a>  <span class="at">width =</span> <span class="dv">29</span>,</span>
<span id="cb192-6" class="hljs-ln-code"><a href="#cb192-6"></a>  <span class="at">height =</span> <span class="dv">21</span>,</span>
<span id="cb192-7" class="hljs-ln-code"><a href="#cb192-7"></a>  <span class="at">units =</span> <span class="st">"cm"</span></span>
<span id="cb192-8" class="hljs-ln-code"><a href="#cb192-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img src="template/logo_marbec.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://github.com/umr-marbec/tidyverse-training">https://github.com/umr-marbec/tidyverse-training</a></p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="tidyverse-training_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="tidyverse-training_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="tidyverse-training_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="tidyverse-training_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>